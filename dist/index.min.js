(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Libp2PTcp = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var Libp2PTcp=(()=>{var ic=Object.create;var We=Object.defineProperty;var ac=Object.getOwnPropertyDescriptor;var cc=Object.getOwnPropertyNames;var uc=Object.getPrototypeOf,lc=Object.prototype.hasOwnProperty;var xt=(r=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(r,{get:(t,e)=>(typeof require<"u"?require:t)[e]}):r)(function(r){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+r+'" is not supported')});var V=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports),ct=(r,t)=>{for(var e in t)We(r,e,{get:t[e],enumerable:!0})},ho=(r,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of cc(t))!lc.call(r,o)&&o!==e&&We(r,o,{get:()=>t[o],enumerable:!(n=ac(t,o))||n.enumerable});return r};var N=(r,t,e)=>(e=r!=null?ic(uc(r)):{},ho(t||!r||!r.__esModule?We(e,"default",{value:r,enumerable:!0}):e,r)),fc=r=>ho(We({},"__esModule",{value:!0}),r);var $o=V((jp,No)=>{No.exports=Kr;var Fo=128,Tu=127,Eu=~Tu,Cu=Math.pow(2,31);function Kr(r,t,e){if(Number.MAX_SAFE_INTEGER&&r>Number.MAX_SAFE_INTEGER)throw Kr.bytes=0,new RangeError("Could not encode varint");t=t||[],e=e||0;for(var n=e;r>=Cu;)t[e++]=r&255|Fo,r/=128;for(;r&Eu;)t[e++]=r&255|Fo,r>>>=7;return t[e]=r|0,Kr.bytes=e-n+1,t}});var zo=V((qp,Lo)=>{Lo.exports=tn;var Au=128,Uo=127;function tn(r,n){var e=0,n=n||0,o=0,c=n,l,p=r.length;do{if(c>=p||o>49)throw tn.bytes=0,new RangeError("Could not decode varint");l=r[c++],e+=o<28?(l&Uo)<<o:(l&Uo)*Math.pow(2,o),o+=7}while(l>=Au);return tn.bytes=c-n,e}});var jo=V((Gp,Vo)=>{var Iu=Math.pow(2,7),Bu=Math.pow(2,14),Ru=Math.pow(2,21),Mu=Math.pow(2,28),Pu=Math.pow(2,35),Du=Math.pow(2,42),Ou=Math.pow(2,49),_u=Math.pow(2,56),ku=Math.pow(2,63);Vo.exports=function(r){return r<Iu?1:r<Bu?2:r<Ru?3:r<Mu?4:r<Pu?5:r<Du?6:r<Ou?7:r<_u?8:r<ku?9:10}});var St=V((Wp,qo)=>{qo.exports={encode:$o(),decode:zo(),encodingLength:jo()}});var fs=V((gd,ls)=>{var ce=1e3,ue=ce*60,le=ue*60,Jt=le*24,fl=Jt*7,pl=Jt*365.25;ls.exports=function(r,t){t=t||{};var e=typeof r;if(e==="string"&&r.length>0)return hl(r);if(e==="number"&&isFinite(r))return t.long?ml(r):dl(r);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))};function hl(r){if(r=String(r),!(r.length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r);if(t){var e=parseFloat(t[1]),n=(t[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return e*pl;case"weeks":case"week":case"w":return e*fl;case"days":case"day":case"d":return e*Jt;case"hours":case"hour":case"hrs":case"hr":case"h":return e*le;case"minutes":case"minute":case"mins":case"min":case"m":return e*ue;case"seconds":case"second":case"secs":case"sec":case"s":return e*ce;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return e;default:return}}}}function dl(r){var t=Math.abs(r);return t>=Jt?Math.round(r/Jt)+"d":t>=le?Math.round(r/le)+"h":t>=ue?Math.round(r/ue)+"m":t>=ce?Math.round(r/ce)+"s":r+"ms"}function ml(r){var t=Math.abs(r);return t>=Jt?rr(r,t,Jt,"day"):t>=le?rr(r,t,le,"hour"):t>=ue?rr(r,t,ue,"minute"):t>=ce?rr(r,t,ce,"second"):r+" ms"}function rr(r,t,e,n){var o=t>=e*1.5;return Math.round(r/e)+" "+n+(o?"s":"")}});var mn=V((wd,ps)=>{function gl(r){e.debug=e,e.default=e,e.coerce=v,e.disable=c,e.enable=o,e.enabled=l,e.humanize=fs(),e.destroy=T,Object.keys(r).forEach(f=>{e[f]=r[f]}),e.names=[],e.skips=[],e.formatters={};function t(f){let w=0;for(let y=0;y<f.length;y++)w=(w<<5)-w+f.charCodeAt(y),w|=0;return e.colors[Math.abs(w)%e.colors.length]}e.selectColor=t;function e(f){let w,y=null,g,d;function A(...M){if(!A.enabled)return;let I=A,B=Number(new Date),z=B-(w||B);I.diff=z,I.prev=w,I.curr=B,w=B,M[0]=e.coerce(M[0]),typeof M[0]!="string"&&M.unshift("%O");let j=0;M[0]=M[0].replace(/%([a-zA-Z%])/g,(nt,et)=>{if(nt==="%%")return"%";j++;let ot=e.formatters[et];if(typeof ot=="function"){let gt=M[j];nt=ot.call(I,gt),M.splice(j,1),j--}return nt}),e.formatArgs.call(I,M),(I.log||e.log).apply(I,M)}return A.namespace=f,A.useColors=e.useColors(),A.color=e.selectColor(f),A.extend=n,A.destroy=e.destroy,Object.defineProperty(A,"enabled",{enumerable:!0,configurable:!1,get:()=>y!==null?y:(g!==e.namespaces&&(g=e.namespaces,d=e.enabled(f)),d),set:M=>{y=M}}),typeof e.init=="function"&&e.init(A),A}function n(f,w){let y=e(this.namespace+(typeof w>"u"?":":w)+f);return y.log=this.log,y}function o(f){e.save(f),e.namespaces=f,e.names=[],e.skips=[];let w,y=(typeof f=="string"?f:"").split(/[\s,]+/),g=y.length;for(w=0;w<g;w++)y[w]&&(f=y[w].replace(/\*/g,".*?"),f[0]==="-"?e.skips.push(new RegExp("^"+f.slice(1)+"$")):e.names.push(new RegExp("^"+f+"$")))}function c(){let f=[...e.names.map(p),...e.skips.map(p).map(w=>"-"+w)].join(",");return e.enable(""),f}function l(f){if(f[f.length-1]==="*")return!0;let w,y;for(w=0,y=e.skips.length;w<y;w++)if(e.skips[w].test(f))return!1;for(w=0,y=e.names.length;w<y;w++)if(e.names[w].test(f))return!0;return!1}function p(f){return f.toString().substring(2,f.toString().length-2).replace(/\.\*\?$/,"*")}function v(f){return f instanceof Error?f.stack||f.message:f}function T(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return e.enable(e.load()),e}ps.exports=gl});var hs=V((ut,nr)=>{ut.formatArgs=bl;ut.save=yl;ut.load=vl;ut.useColors=wl;ut.storage=xl();ut.destroy=(()=>{let r=!1;return()=>{r||(r=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();ut.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function wl(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function bl(r){if(r[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+r[0]+(this.useColors?"%c ":" ")+"+"+nr.exports.humanize(this.diff),!this.useColors)return;let t="color: "+this.color;r.splice(1,0,t,"color: inherit");let e=0,n=0;r[0].replace(/%[a-zA-Z%]/g,o=>{o!=="%%"&&(e++,o==="%c"&&(n=e))}),r.splice(n,0,t)}ut.log=console.debug||console.log||(()=>{});function yl(r){try{r?ut.storage.setItem("debug",r):ut.storage.removeItem("debug")}catch{}}function vl(){let r;try{r=ut.storage.getItem("debug")}catch{}return!r&&typeof process<"u"&&"env"in process&&(r=process.env.DEBUG),r}function xl(){try{return localStorage}catch{}}nr.exports=mn()(ut);var{formatters:Sl}=nr.exports;Sl.j=function(r){try{return JSON.stringify(r)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}});var ms=V((bd,ds)=>{"use strict";ds.exports=(r,t=process.argv)=>{let e=r.startsWith("-")?"":r.length===1?"-":"--",n=t.indexOf(e+r),o=t.indexOf("--");return n!==-1&&(o===-1||n<o)}});var bs=V((yd,ws)=>{"use strict";var Tl=xt("os"),gs=xt("tty"),dt=ms(),{env:W}=process,Vt;dt("no-color")||dt("no-colors")||dt("color=false")||dt("color=never")?Vt=0:(dt("color")||dt("colors")||dt("color=true")||dt("color=always"))&&(Vt=1);"FORCE_COLOR"in W&&(W.FORCE_COLOR==="true"?Vt=1:W.FORCE_COLOR==="false"?Vt=0:Vt=W.FORCE_COLOR.length===0?1:Math.min(parseInt(W.FORCE_COLOR,10),3));function gn(r){return r===0?!1:{level:r,hasBasic:!0,has256:r>=2,has16m:r>=3}}function wn(r,t){if(Vt===0)return 0;if(dt("color=16m")||dt("color=full")||dt("color=truecolor"))return 3;if(dt("color=256"))return 2;if(r&&!t&&Vt===void 0)return 0;let e=Vt||0;if(W.TERM==="dumb")return e;if(process.platform==="win32"){let n=Tl.release().split(".");return Number(n[0])>=10&&Number(n[2])>=10586?Number(n[2])>=14931?3:2:1}if("CI"in W)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some(n=>n in W)||W.CI_NAME==="codeship"?1:e;if("TEAMCITY_VERSION"in W)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(W.TEAMCITY_VERSION)?1:0;if(W.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in W){let n=parseInt((W.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(W.TERM_PROGRAM){case"iTerm.app":return n>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(W.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(W.TERM)||"COLORTERM"in W?1:e}function El(r){let t=wn(r,r&&r.isTTY);return gn(t)}ws.exports={supportsColor:El,stdout:gn(wn(!0,gs.isatty(1))),stderr:gn(wn(!0,gs.isatty(2)))}});var vs=V((J,sr)=>{var Cl=xt("tty"),or=xt("util");J.init=Dl;J.log=Rl;J.formatArgs=Il;J.save=Ml;J.load=Pl;J.useColors=Al;J.destroy=or.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");J.colors=[6,2,3,4,5,1];try{let r=bs();r&&(r.stderr||r).level>=2&&(J.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}J.inspectOpts=Object.keys(process.env).filter(r=>/^debug_/i.test(r)).reduce((r,t)=>{let e=t.substring(6).toLowerCase().replace(/_([a-z])/g,(o,c)=>c.toUpperCase()),n=process.env[t];return/^(yes|on|true|enabled)$/i.test(n)?n=!0:/^(no|off|false|disabled)$/i.test(n)?n=!1:n==="null"?n=null:n=Number(n),r[e]=n,r},{});function Al(){return"colors"in J.inspectOpts?!!J.inspectOpts.colors:Cl.isatty(process.stderr.fd)}function Il(r){let{namespace:t,useColors:e}=this;if(e){let n=this.color,o="\x1B[3"+(n<8?n:"8;5;"+n),c=`  ${o};1m${t} \x1B[0m`;r[0]=c+r[0].split(`
`).join(`
`+c),r.push(o+"m+"+sr.exports.humanize(this.diff)+"\x1B[0m")}else r[0]=Bl()+t+" "+r[0]}function Bl(){return J.inspectOpts.hideDate?"":new Date().toISOString()+" "}function Rl(...r){return process.stderr.write(or.format(...r)+`
`)}function Ml(r){r?process.env.DEBUG=r:delete process.env.DEBUG}function Pl(){return process.env.DEBUG}function Dl(r){r.inspectOpts={};let t=Object.keys(J.inspectOpts);for(let e=0;e<t.length;e++)r.inspectOpts[t[e]]=J.inspectOpts[t[e]]}sr.exports=mn()(J);var{formatters:ys}=sr.exports;ys.o=function(r){return this.inspectOpts.colors=this.useColors,or.inspect(r,this.inspectOpts).split(`
`).map(t=>t.trim()).join(" ")};ys.O=function(r){return this.inspectOpts.colors=this.useColors,or.inspect(r,this.inspectOpts)}});var xs=V((vd,bn)=>{typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?bn.exports=hs():bn.exports=vs()});var ir=V((Cd,Ss)=>{Ss.exports=r=>{if(r[Symbol.asyncIterator])return r;if(r.getReader)return async function*(){let t=r.getReader();try{for(;;){let{done:e,value:n}=await t.read();if(e)return;yield n}}finally{t.releaseLock()}}();throw new Error("unknown stream")}});var Es=V((Ad,Ts)=>{Ts.exports=function(t){if(t){if(typeof t[Symbol.iterator]=="function")return t[Symbol.iterator]();if(typeof t[Symbol.asyncIterator]=="function")return t[Symbol.asyncIterator]();if(typeof t.next=="function")return t}throw new Error("argument is not an iterator or iterable")}});var yn=V((Id,Cs)=>{var _l=Es();Cs.exports=r=>async t=>{t=_l(t);let e=I=>{typeof I.return=="function"&&I.return()},n=null,o=null,c=I=>{n=I,o&&o(I),e(t)},l=null,p=!1,v=()=>{p=!0,l&&l()},T=null,f=!1,w=()=>{f=!0,T&&T()},y=null,g=()=>{y&&y()},d=()=>new Promise((I,B)=>{l=y=I,o=B,r.once("drain",g)}),A=()=>(e(t),new Promise((I,B)=>{if(p||f||n)return I();T=l=I,o=B})),M=()=>{r.removeListener("error",c),r.removeListener("close",v),r.removeListener("finish",w),r.removeListener("drain",g)};r.once("error",c),r.once("close",v),r.once("finish",w);try{for await(let I of t){if(!r.writable||r.destroyed||n)break;r.write(I)===!1&&await d()}}catch(I){n||r.destroy(),n=I}try{if(r.writable&&r.end(),await A(),n)throw n}finally{M()}}});var vn=V((Bd,As)=>{var kl=yn(),Fl=ir();As.exports=r=>({sink:kl(r),source:Fl(r)})});var Bs=V((Rd,Is)=>{var Nl=vn();Is.exports=r=>async function*(t){let e=Nl(r),n;if(e.sink(t).catch(o=>{n=o}),yield*e.source,n)throw n}});var Rs=V((Md,fe)=>{fe.exports=ir();fe.exports.source=ir();fe.exports.sink=yn();fe.exports.transform=Bs();fe.exports.duplex=vn()});var On=V((pr,Gs)=>{(function(){var r,t=0xdeadbeefcafe,e=(t&16777215)==15715070;function n(s,i,a){s!=null&&(typeof s=="number"?this.fromNumber(s,i,a):i==null&&typeof s!="string"?this.fromString(s,256):this.fromString(s,i))}function o(){return new n(null)}function c(s,i,a,u,h,m){for(;--m>=0;){var b=i*this[s++]+a[u]+h;h=Math.floor(b/67108864),a[u++]=b&67108863}return h}function l(s,i,a,u,h,m){for(var b=i&32767,x=i>>15;--m>=0;){var _=this[s]&32767,G=this[s++]>>15,ft=x*_+G*b;_=b*_+((ft&32767)<<15)+a[u]+(h&1073741823),h=(_>>>30)+(ft>>>15)+x*G+(h>>>30),a[u++]=_&1073741823}return h}function p(s,i,a,u,h,m){for(var b=i&16383,x=i>>14;--m>=0;){var _=this[s]&16383,G=this[s++]>>14,ft=x*_+G*b;_=b*_+((ft&16383)<<14)+a[u]+h,h=(_>>28)+(ft>>14)+x*G,a[u++]=_&268435455}return h}var v=typeof navigator<"u";v&&e&&navigator.appName=="Microsoft Internet Explorer"?(n.prototype.am=l,r=30):v&&e&&navigator.appName!="Netscape"?(n.prototype.am=c,r=26):(n.prototype.am=p,r=28),n.prototype.DB=r,n.prototype.DM=(1<<r)-1,n.prototype.DV=1<<r;var T=52;n.prototype.FV=Math.pow(2,T),n.prototype.F1=T-r,n.prototype.F2=2*r-T;var f="0123456789abcdefghijklmnopqrstuvwxyz",w=new Array,y,g;for(y="0".charCodeAt(0),g=0;g<=9;++g)w[y++]=g;for(y="a".charCodeAt(0),g=10;g<36;++g)w[y++]=g;for(y="A".charCodeAt(0),g=10;g<36;++g)w[y++]=g;function d(s){return f.charAt(s)}function A(s,i){var a=w[s.charCodeAt(i)];return a??-1}function M(s){for(var i=this.t-1;i>=0;--i)s[i]=this[i];s.t=this.t,s.s=this.s}function I(s){this.t=1,this.s=s<0?-1:0,s>0?this[0]=s:s<-1?this[0]=s+this.DV:this.t=0}function B(s){var i=o();return i.fromInt(s),i}function z(s,i){var a;if(i==16)a=4;else if(i==8)a=3;else if(i==256)a=8;else if(i==2)a=1;else if(i==32)a=5;else if(i==4)a=2;else{this.fromRadix(s,i);return}this.t=0,this.s=0;for(var u=s.length,h=!1,m=0;--u>=0;){var b=a==8?s[u]&255:A(s,u);if(b<0){s.charAt(u)=="-"&&(h=!0);continue}h=!1,m==0?this[this.t++]=b:m+a>this.DB?(this[this.t-1]|=(b&(1<<this.DB-m)-1)<<m,this[this.t++]=b>>this.DB-m):this[this.t-1]|=b<<m,m+=a,m>=this.DB&&(m-=this.DB)}a==8&&s[0]&128&&(this.s=-1,m>0&&(this[this.t-1]|=(1<<this.DB-m)-1<<m)),this.clamp(),h&&n.ZERO.subTo(this,this)}function j(){for(var s=this.s&this.DM;this.t>0&&this[this.t-1]==s;)--this.t}function st(s){if(this.s<0)return"-"+this.negate().toString(s);var i;if(s==16)i=4;else if(s==8)i=3;else if(s==2)i=1;else if(s==32)i=5;else if(s==4)i=2;else return this.toRadix(s);var a=(1<<i)-1,u,h=!1,m="",b=this.t,x=this.DB-b*this.DB%i;if(b-- >0)for(x<this.DB&&(u=this[b]>>x)>0&&(h=!0,m=d(u));b>=0;)x<i?(u=(this[b]&(1<<x)-1)<<i-x,u|=this[--b]>>(x+=this.DB-i)):(u=this[b]>>(x-=i)&a,x<=0&&(x+=this.DB,--b)),u>0&&(h=!0),h&&(m+=d(u));return h?m:"0"}function nt(){var s=o();return n.ZERO.subTo(this,s),s}function et(){return this.s<0?this.negate():this}function ot(s){var i=this.s-s.s;if(i!=0)return i;var a=this.t;if(i=a-s.t,i!=0)return this.s<0?-i:i;for(;--a>=0;)if((i=this[a]-s[a])!=0)return i;return 0}function gt(s){var i=1,a;return(a=s>>>16)!=0&&(s=a,i+=16),(a=s>>8)!=0&&(s=a,i+=8),(a=s>>4)!=0&&(s=a,i+=4),(a=s>>2)!=0&&(s=a,i+=2),(a=s>>1)!=0&&(s=a,i+=1),i}function Ai(){return this.t<=0?0:this.DB*(this.t-1)+gt(this[this.t-1]^this.s&this.DM)}function Ii(s,i){var a;for(a=this.t-1;a>=0;--a)i[a+s]=this[a];for(a=s-1;a>=0;--a)i[a]=0;i.t=this.t+s,i.s=this.s}function Bi(s,i){for(var a=s;a<this.t;++a)i[a-s]=this[a];i.t=Math.max(this.t-s,0),i.s=this.s}function Ri(s,i){var a=s%this.DB,u=this.DB-a,h=(1<<u)-1,m=Math.floor(s/this.DB),b=this.s<<a&this.DM,x;for(x=this.t-1;x>=0;--x)i[x+m+1]=this[x]>>u|b,b=(this[x]&h)<<a;for(x=m-1;x>=0;--x)i[x]=0;i[m]=b,i.t=this.t+m+1,i.s=this.s,i.clamp()}function Mi(s,i){i.s=this.s;var a=Math.floor(s/this.DB);if(a>=this.t){i.t=0;return}var u=s%this.DB,h=this.DB-u,m=(1<<u)-1;i[0]=this[a]>>u;for(var b=a+1;b<this.t;++b)i[b-a-1]|=(this[b]&m)<<h,i[b-a]=this[b]>>u;u>0&&(i[this.t-a-1]|=(this.s&m)<<h),i.t=this.t-a,i.clamp()}function Pi(s,i){for(var a=0,u=0,h=Math.min(s.t,this.t);a<h;)u+=this[a]-s[a],i[a++]=u&this.DM,u>>=this.DB;if(s.t<this.t){for(u-=s.s;a<this.t;)u+=this[a],i[a++]=u&this.DM,u>>=this.DB;u+=this.s}else{for(u+=this.s;a<s.t;)u-=s[a],i[a++]=u&this.DM,u>>=this.DB;u-=s.s}i.s=u<0?-1:0,u<-1?i[a++]=this.DV+u:u>0&&(i[a++]=u),i.t=a,i.clamp()}function Di(s,i){var a=this.abs(),u=s.abs(),h=a.t;for(i.t=h+u.t;--h>=0;)i[h]=0;for(h=0;h<u.t;++h)i[h+a.t]=a.am(0,u[h],i,h,0,a.t);i.s=0,i.clamp(),this.s!=s.s&&n.ZERO.subTo(i,i)}function Oi(s){for(var i=this.abs(),a=s.t=2*i.t;--a>=0;)s[a]=0;for(a=0;a<i.t-1;++a){var u=i.am(a,i[a],s,2*a,0,1);(s[a+i.t]+=i.am(a+1,2*i[a],s,2*a+1,u,i.t-a-1))>=i.DV&&(s[a+i.t]-=i.DV,s[a+i.t+1]=1)}s.t>0&&(s[s.t-1]+=i.am(a,i[a],s,2*a,0,1)),s.s=0,s.clamp()}function _i(s,i,a){var u=s.abs();if(!(u.t<=0)){var h=this.abs();if(h.t<u.t){i?.fromInt(0),a!=null&&this.copyTo(a);return}a==null&&(a=o());var m=o(),b=this.s,x=s.s,_=this.DB-gt(u[u.t-1]);_>0?(u.lShiftTo(_,m),h.lShiftTo(_,a)):(u.copyTo(m),h.copyTo(a));var G=m.t,ft=m[G-1];if(ft!=0){var at=ft*(1<<this.F1)+(G>1?m[G-2]>>this.F2:0),At=this.FV/at,qe=(1<<this.F1)/at,bt=1<<this.F2,yt=a.t,Ge=yt-G,Ft=i??o();for(m.dlShiftTo(Ge,Ft),a.compareTo(Ft)>=0&&(a[a.t++]=1,a.subTo(Ft,a)),n.ONE.dlShiftTo(G,Ft),Ft.subTo(m,m);m.t<G;)m[m.t++]=0;for(;--Ge>=0;){var Ir=a[--yt]==ft?this.DM:Math.floor(a[yt]*At+(a[yt-1]+bt)*qe);if((a[yt]+=m.am(0,Ir,a,Ge,0,G))<Ir)for(m.dlShiftTo(Ge,Ft),a.subTo(Ft,a);a[yt]<--Ir;)a.subTo(Ft,a)}i!=null&&(a.drShiftTo(G,i),b!=x&&n.ZERO.subTo(i,i)),a.t=G,a.clamp(),_>0&&a.rShiftTo(_,a),b<0&&n.ZERO.subTo(a,a)}}}function ki(s){var i=o();return this.abs().divRemTo(s,null,i),this.s<0&&i.compareTo(n.ZERO)>0&&s.subTo(i,i),i}function qt(s){this.m=s}function Fi(s){return s.s<0||s.compareTo(this.m)>=0?s.mod(this.m):s}function Ni(s){return s}function $i(s){s.divRemTo(this.m,null,s)}function Ui(s,i,a){s.multiplyTo(i,a),this.reduce(a)}function Li(s,i){s.squareTo(i),this.reduce(i)}qt.prototype.convert=Fi,qt.prototype.revert=Ni,qt.prototype.reduce=$i,qt.prototype.mulTo=Ui,qt.prototype.sqrTo=Li;function zi(){if(this.t<1)return 0;var s=this[0];if(!(s&1))return 0;var i=s&3;return i=i*(2-(s&15)*i)&15,i=i*(2-(s&255)*i)&255,i=i*(2-((s&65535)*i&65535))&65535,i=i*(2-s*i%this.DV)%this.DV,i>0?this.DV-i:-i}function Gt(s){this.m=s,this.mp=s.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<s.DB-15)-1,this.mt2=2*s.t}function Vi(s){var i=o();return s.abs().dlShiftTo(this.m.t,i),i.divRemTo(this.m,null,i),s.s<0&&i.compareTo(n.ZERO)>0&&this.m.subTo(i,i),i}function ji(s){var i=o();return s.copyTo(i),this.reduce(i),i}function qi(s){for(;s.t<=this.mt2;)s[s.t++]=0;for(var i=0;i<this.m.t;++i){var a=s[i]&32767,u=a*this.mpl+((a*this.mph+(s[i]>>15)*this.mpl&this.um)<<15)&s.DM;for(a=i+this.m.t,s[a]+=this.m.am(0,u,s,i,0,this.m.t);s[a]>=s.DV;)s[a]-=s.DV,s[++a]++}s.clamp(),s.drShiftTo(this.m.t,s),s.compareTo(this.m)>=0&&s.subTo(this.m,s)}function Gi(s,i){s.squareTo(i),this.reduce(i)}function Wi(s,i,a){s.multiplyTo(i,a),this.reduce(a)}Gt.prototype.convert=Vi,Gt.prototype.revert=ji,Gt.prototype.reduce=qi,Gt.prototype.mulTo=Wi,Gt.prototype.sqrTo=Gi;function Hi(){return(this.t>0?this[0]&1:this.s)==0}function Zi(s,i){if(s>4294967295||s<1)return n.ONE;var a=o(),u=o(),h=i.convert(this),m=gt(s)-1;for(h.copyTo(a);--m>=0;)if(i.sqrTo(a,u),(s&1<<m)>0)i.mulTo(u,h,a);else{var b=a;a=u,u=b}return i.revert(a)}function Ji(s,i){var a;return s<256||i.isEven()?a=new qt(i):a=new Gt(i),this.exp(s,a)}n.prototype.copyTo=M,n.prototype.fromInt=I,n.prototype.fromString=z,n.prototype.clamp=j,n.prototype.dlShiftTo=Ii,n.prototype.drShiftTo=Bi,n.prototype.lShiftTo=Ri,n.prototype.rShiftTo=Mi,n.prototype.subTo=Pi,n.prototype.multiplyTo=Di,n.prototype.squareTo=Oi,n.prototype.divRemTo=_i,n.prototype.invDigit=zi,n.prototype.isEven=Hi,n.prototype.exp=Zi,n.prototype.toString=st,n.prototype.negate=nt,n.prototype.abs=et,n.prototype.compareTo=ot,n.prototype.bitLength=Ai,n.prototype.mod=ki,n.prototype.modPowInt=Ji,n.ZERO=B(0),n.ONE=B(1);function Xi(){var s=o();return this.copyTo(s),s}function Qi(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function Yi(){return this.t==0?this.s:this[0]<<24>>24}function Ki(){return this.t==0?this.s:this[0]<<16>>16}function ta(s){return Math.floor(Math.LN2*this.DB/Math.log(s))}function ea(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}function ra(s){if(s==null&&(s=10),this.signum()==0||s<2||s>36)return"0";var i=this.chunkSize(s),a=Math.pow(s,i),u=B(a),h=o(),m=o(),b="";for(this.divRemTo(u,h,m);h.signum()>0;)b=(a+m.intValue()).toString(s).substr(1)+b,h.divRemTo(u,h,m);return m.intValue().toString(s)+b}function na(s,i){this.fromInt(0),i==null&&(i=10);for(var a=this.chunkSize(i),u=Math.pow(i,a),h=!1,m=0,b=0,x=0;x<s.length;++x){var _=A(s,x);if(_<0){s.charAt(x)=="-"&&this.signum()==0&&(h=!0);continue}b=i*b+_,++m>=a&&(this.dMultiply(u),this.dAddOffset(b,0),m=0,b=0)}m>0&&(this.dMultiply(Math.pow(i,m)),this.dAddOffset(b,0)),h&&n.ZERO.subTo(this,this)}function oa(s,i,a){if(typeof i=="number")if(s<2)this.fromInt(1);else for(this.fromNumber(s,a),this.testBit(s-1)||this.bitwiseTo(n.ONE.shiftLeft(s-1),Tr,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(i);)this.dAddOffset(2,0),this.bitLength()>s&&this.subTo(n.ONE.shiftLeft(s-1),this);else{var u=new Array,h=s&7;u.length=(s>>3)+1,i.nextBytes(u),h>0?u[0]&=(1<<h)-1:u[0]=0,this.fromString(u,256)}}function sa(){var s=this.t,i=new Array;i[0]=this.s;var a=this.DB-s*this.DB%8,u,h=0;if(s-- >0)for(a<this.DB&&(u=this[s]>>a)!=(this.s&this.DM)>>a&&(i[h++]=u|this.s<<this.DB-a);s>=0;)a<8?(u=(this[s]&(1<<a)-1)<<8-a,u|=this[--s]>>(a+=this.DB-8)):(u=this[s]>>(a-=8)&255,a<=0&&(a+=this.DB,--s)),u&128&&(u|=-256),h==0&&(this.s&128)!=(u&128)&&++h,(h>0||u!=this.s)&&(i[h++]=u);return i}function ia(s){return this.compareTo(s)==0}function aa(s){return this.compareTo(s)<0?this:s}function ca(s){return this.compareTo(s)>0?this:s}function ua(s,i,a){var u,h,m=Math.min(s.t,this.t);for(u=0;u<m;++u)a[u]=i(this[u],s[u]);if(s.t<this.t){for(h=s.s&this.DM,u=m;u<this.t;++u)a[u]=i(this[u],h);a.t=this.t}else{for(h=this.s&this.DM,u=m;u<s.t;++u)a[u]=i(h,s[u]);a.t=s.t}a.s=i(this.s,s.s),a.clamp()}function la(s,i){return s&i}function fa(s){var i=o();return this.bitwiseTo(s,la,i),i}function Tr(s,i){return s|i}function pa(s){var i=o();return this.bitwiseTo(s,Tr,i),i}function ao(s,i){return s^i}function ha(s){var i=o();return this.bitwiseTo(s,ao,i),i}function co(s,i){return s&~i}function da(s){var i=o();return this.bitwiseTo(s,co,i),i}function ma(){for(var s=o(),i=0;i<this.t;++i)s[i]=this.DM&~this[i];return s.t=this.t,s.s=~this.s,s}function ga(s){var i=o();return s<0?this.rShiftTo(-s,i):this.lShiftTo(s,i),i}function wa(s){var i=o();return s<0?this.lShiftTo(-s,i):this.rShiftTo(s,i),i}function ba(s){if(s==0)return-1;var i=0;return s&65535||(s>>=16,i+=16),s&255||(s>>=8,i+=8),s&15||(s>>=4,i+=4),s&3||(s>>=2,i+=2),s&1||++i,i}function ya(){for(var s=0;s<this.t;++s)if(this[s]!=0)return s*this.DB+ba(this[s]);return this.s<0?this.t*this.DB:-1}function va(s){for(var i=0;s!=0;)s&=s-1,++i;return i}function xa(){for(var s=0,i=this.s&this.DM,a=0;a<this.t;++a)s+=va(this[a]^i);return s}function Sa(s){var i=Math.floor(s/this.DB);return i>=this.t?this.s!=0:(this[i]&1<<s%this.DB)!=0}function Ta(s,i){var a=n.ONE.shiftLeft(s);return this.bitwiseTo(a,i,a),a}function Ea(s){return this.changeBit(s,Tr)}function Ca(s){return this.changeBit(s,co)}function Aa(s){return this.changeBit(s,ao)}function Ia(s,i){for(var a=0,u=0,h=Math.min(s.t,this.t);a<h;)u+=this[a]+s[a],i[a++]=u&this.DM,u>>=this.DB;if(s.t<this.t){for(u+=s.s;a<this.t;)u+=this[a],i[a++]=u&this.DM,u>>=this.DB;u+=this.s}else{for(u+=this.s;a<s.t;)u+=s[a],i[a++]=u&this.DM,u>>=this.DB;u+=s.s}i.s=u<0?-1:0,u>0?i[a++]=u:u<-1&&(i[a++]=this.DV+u),i.t=a,i.clamp()}function Ba(s){var i=o();return this.addTo(s,i),i}function Ra(s){var i=o();return this.subTo(s,i),i}function Ma(s){var i=o();return this.multiplyTo(s,i),i}function Pa(){var s=o();return this.squareTo(s),s}function Da(s){var i=o();return this.divRemTo(s,i,null),i}function Oa(s){var i=o();return this.divRemTo(s,null,i),i}function _a(s){var i=o(),a=o();return this.divRemTo(s,i,a),new Array(i,a)}function ka(s){this[this.t]=this.am(0,s-1,this,0,0,this.t),++this.t,this.clamp()}function Fa(s,i){if(s!=0){for(;this.t<=i;)this[this.t++]=0;for(this[i]+=s;this[i]>=this.DV;)this[i]-=this.DV,++i>=this.t&&(this[this.t++]=0),++this[i]}}function xe(){}function uo(s){return s}function Na(s,i,a){s.multiplyTo(i,a)}function $a(s,i){s.squareTo(i)}xe.prototype.convert=uo,xe.prototype.revert=uo,xe.prototype.mulTo=Na,xe.prototype.sqrTo=$a;function Ua(s){return this.exp(s,new xe)}function La(s,i,a){var u=Math.min(this.t+s.t,i);for(a.s=0,a.t=u;u>0;)a[--u]=0;var h;for(h=a.t-this.t;u<h;++u)a[u+this.t]=this.am(0,s[u],a,u,0,this.t);for(h=Math.min(s.t,i);u<h;++u)this.am(0,s[u],a,u,0,i-u);a.clamp()}function za(s,i,a){--i;var u=a.t=this.t+s.t-i;for(a.s=0;--u>=0;)a[u]=0;for(u=Math.max(i-this.t,0);u<s.t;++u)a[this.t+u-i]=this.am(i-u,s[u],a,0,0,this.t+u-i);a.clamp(),a.drShiftTo(1,a)}function Wt(s){this.r2=o(),this.q3=o(),n.ONE.dlShiftTo(2*s.t,this.r2),this.mu=this.r2.divide(s),this.m=s}function Va(s){if(s.s<0||s.t>2*this.m.t)return s.mod(this.m);if(s.compareTo(this.m)<0)return s;var i=o();return s.copyTo(i),this.reduce(i),i}function ja(s){return s}function qa(s){for(s.drShiftTo(this.m.t-1,this.r2),s.t>this.m.t+1&&(s.t=this.m.t+1,s.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);s.compareTo(this.r2)<0;)s.dAddOffset(1,this.m.t+1);for(s.subTo(this.r2,s);s.compareTo(this.m)>=0;)s.subTo(this.m,s)}function Ga(s,i){s.squareTo(i),this.reduce(i)}function Wa(s,i,a){s.multiplyTo(i,a),this.reduce(a)}Wt.prototype.convert=Va,Wt.prototype.revert=ja,Wt.prototype.reduce=qa,Wt.prototype.mulTo=Wa,Wt.prototype.sqrTo=Ga;function Ha(s,i){var a=s.bitLength(),u,h=B(1),m;if(a<=0)return h;a<18?u=1:a<48?u=3:a<144?u=4:a<768?u=5:u=6,a<8?m=new qt(i):i.isEven()?m=new Wt(i):m=new Gt(i);var b=new Array,x=3,_=u-1,G=(1<<u)-1;if(b[1]=m.convert(this),u>1){var ft=o();for(m.sqrTo(b[1],ft);x<=G;)b[x]=o(),m.mulTo(ft,b[x-2],b[x]),x+=2}var at=s.t-1,At,qe=!0,bt=o(),yt;for(a=gt(s[at])-1;at>=0;){for(a>=_?At=s[at]>>a-_&G:(At=(s[at]&(1<<a+1)-1)<<_-a,at>0&&(At|=s[at-1]>>this.DB+a-_)),x=u;!(At&1);)At>>=1,--x;if((a-=x)<0&&(a+=this.DB,--at),qe)b[At].copyTo(h),qe=!1;else{for(;x>1;)m.sqrTo(h,bt),m.sqrTo(bt,h),x-=2;x>0?m.sqrTo(h,bt):(yt=h,h=bt,bt=yt),m.mulTo(bt,b[At],h)}for(;at>=0&&!(s[at]&1<<a);)m.sqrTo(h,bt),yt=h,h=bt,bt=yt,--a<0&&(a=this.DB-1,--at)}return m.revert(h)}function Za(s){var i=this.s<0?this.negate():this.clone(),a=s.s<0?s.negate():s.clone();if(i.compareTo(a)<0){var u=i;i=a,a=u}var h=i.getLowestSetBit(),m=a.getLowestSetBit();if(m<0)return i;for(h<m&&(m=h),m>0&&(i.rShiftTo(m,i),a.rShiftTo(m,a));i.signum()>0;)(h=i.getLowestSetBit())>0&&i.rShiftTo(h,i),(h=a.getLowestSetBit())>0&&a.rShiftTo(h,a),i.compareTo(a)>=0?(i.subTo(a,i),i.rShiftTo(1,i)):(a.subTo(i,a),a.rShiftTo(1,a));return m>0&&a.lShiftTo(m,a),a}function Ja(s){if(s<=0)return 0;var i=this.DV%s,a=this.s<0?s-1:0;if(this.t>0)if(i==0)a=this[0]%s;else for(var u=this.t-1;u>=0;--u)a=(i*a+this[u])%s;return a}function Xa(s){var i=s.isEven();if(this.isEven()&&i||s.signum()==0)return n.ZERO;for(var a=s.clone(),u=this.clone(),h=B(1),m=B(0),b=B(0),x=B(1);a.signum()!=0;){for(;a.isEven();)a.rShiftTo(1,a),i?((!h.isEven()||!m.isEven())&&(h.addTo(this,h),m.subTo(s,m)),h.rShiftTo(1,h)):m.isEven()||m.subTo(s,m),m.rShiftTo(1,m);for(;u.isEven();)u.rShiftTo(1,u),i?((!b.isEven()||!x.isEven())&&(b.addTo(this,b),x.subTo(s,x)),b.rShiftTo(1,b)):x.isEven()||x.subTo(s,x),x.rShiftTo(1,x);a.compareTo(u)>=0?(a.subTo(u,a),i&&h.subTo(b,h),m.subTo(x,m)):(u.subTo(a,u),i&&b.subTo(h,b),x.subTo(m,x))}if(u.compareTo(n.ONE)!=0)return n.ZERO;if(x.compareTo(s)>=0)return x.subtract(s);if(x.signum()<0)x.addTo(s,x);else return x;return x.signum()<0?x.add(s):x}var rt=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],Qa=(1<<26)/rt[rt.length-1];function Ya(s){var i,a=this.abs();if(a.t==1&&a[0]<=rt[rt.length-1]){for(i=0;i<rt.length;++i)if(a[0]==rt[i])return!0;return!1}if(a.isEven())return!1;for(i=1;i<rt.length;){for(var u=rt[i],h=i+1;h<rt.length&&u<Qa;)u*=rt[h++];for(u=a.modInt(u);i<h;)if(u%rt[i++]==0)return!1}return a.millerRabin(s)}function Ka(s){var i=this.subtract(n.ONE),a=i.getLowestSetBit();if(a<=0)return!1;var u=i.shiftRight(a);s=s+1>>1,s>rt.length&&(s=rt.length);for(var h=o(),m=0;m<s;++m){h.fromInt(rt[Math.floor(Math.random()*rt.length)]);var b=h.modPow(u,this);if(b.compareTo(n.ONE)!=0&&b.compareTo(i)!=0){for(var x=1;x++<a&&b.compareTo(i)!=0;)if(b=b.modPowInt(2,this),b.compareTo(n.ONE)==0)return!1;if(b.compareTo(i)!=0)return!1}}return!0}n.prototype.chunkSize=ta,n.prototype.toRadix=ra,n.prototype.fromRadix=na,n.prototype.fromNumber=oa,n.prototype.bitwiseTo=ua,n.prototype.changeBit=Ta,n.prototype.addTo=Ia,n.prototype.dMultiply=ka,n.prototype.dAddOffset=Fa,n.prototype.multiplyLowerTo=La,n.prototype.multiplyUpperTo=za,n.prototype.modInt=Ja,n.prototype.millerRabin=Ka,n.prototype.clone=Xi,n.prototype.intValue=Qi,n.prototype.byteValue=Yi,n.prototype.shortValue=Ki,n.prototype.signum=ea,n.prototype.toByteArray=sa,n.prototype.equals=ia,n.prototype.min=aa,n.prototype.max=ca,n.prototype.and=fa,n.prototype.or=pa,n.prototype.xor=ha,n.prototype.andNot=da,n.prototype.not=ma,n.prototype.shiftLeft=ga,n.prototype.shiftRight=wa,n.prototype.getLowestSetBit=ya,n.prototype.bitCount=xa,n.prototype.testBit=Sa,n.prototype.setBit=Ea,n.prototype.clearBit=Ca,n.prototype.flipBit=Aa,n.prototype.add=Ba,n.prototype.subtract=Ra,n.prototype.multiply=Ma,n.prototype.divide=Da,n.prototype.remainder=Oa,n.prototype.divideAndRemainder=_a,n.prototype.modPow=Ha,n.prototype.modInverse=Xa,n.prototype.pow=Ua,n.prototype.gcd=Za,n.prototype.isProbablePrime=Ya,n.prototype.square=Pa,n.prototype.Barrett=Wt;var je,it,q;function tc(s){it[q++]^=s&255,it[q++]^=s>>8&255,it[q++]^=s>>16&255,it[q++]^=s>>24&255,q>=Ar&&(q-=Ar)}function lo(){tc(new Date().getTime())}if(it==null){it=new Array,q=0;var wt;if(typeof window<"u"&&window.crypto){if(window.crypto.getRandomValues){var fo=new Uint8Array(32);for(window.crypto.getRandomValues(fo),wt=0;wt<32;++wt)it[q++]=fo[wt]}else if(navigator.appName=="Netscape"&&navigator.appVersion<"5"){var po=window.crypto.random(32);for(wt=0;wt<po.length;++wt)it[q++]=po.charCodeAt(wt)&255}}for(;q<Ar;)wt=Math.floor(65536*Math.random()),it[q++]=wt>>>8,it[q++]=wt&255;q=0,lo()}function ec(){if(je==null){for(lo(),je=sc(),je.init(it),q=0;q<it.length;++q)it[q]=0;q=0}return je.next()}function rc(s){var i;for(i=0;i<s.length;++i)s[i]=ec()}function Er(){}Er.prototype.nextBytes=rc;function Cr(){this.i=0,this.j=0,this.S=new Array}function nc(s){var i,a,u;for(i=0;i<256;++i)this.S[i]=i;for(a=0,i=0;i<256;++i)a=a+this.S[i]+s[i%s.length]&255,u=this.S[i],this.S[i]=this.S[a],this.S[a]=u;this.i=0,this.j=0}function oc(){var s;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,s=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=s,this.S[s+this.S[this.i]&255]}Cr.prototype.init=nc,Cr.prototype.next=oc;function sc(){return new Cr}var Ar=256;typeof pr<"u"?pr=Gs.exports={default:n,BigInteger:n,SecureRandom:Er}:this.jsbn={BigInteger:n,SecureRandom:Er}}).call(pr)});var $e=V(hr=>{(function(){"use strict";var r={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function t(l){return n(c(l),arguments)}function e(l,p){return t.apply(null,[l].concat(p||[]))}function n(l,p){var v=1,T=l.length,f,w="",y,g,d,A,M,I,B,z;for(y=0;y<T;y++)if(typeof l[y]=="string")w+=l[y];else if(typeof l[y]=="object"){if(d=l[y],d.keys)for(f=p[v],g=0;g<d.keys.length;g++){if(f==null)throw new Error(t('[sprintf] Cannot access property "%s" of undefined value "%s"',d.keys[g],d.keys[g-1]));f=f[d.keys[g]]}else d.param_no?f=p[d.param_no]:f=p[v++];if(r.not_type.test(d.type)&&r.not_primitive.test(d.type)&&f instanceof Function&&(f=f()),r.numeric_arg.test(d.type)&&typeof f!="number"&&isNaN(f))throw new TypeError(t("[sprintf] expecting number but found %T",f));switch(r.number.test(d.type)&&(B=f>=0),d.type){case"b":f=parseInt(f,10).toString(2);break;case"c":f=String.fromCharCode(parseInt(f,10));break;case"d":case"i":f=parseInt(f,10);break;case"j":f=JSON.stringify(f,null,d.width?parseInt(d.width):0);break;case"e":f=d.precision?parseFloat(f).toExponential(d.precision):parseFloat(f).toExponential();break;case"f":f=d.precision?parseFloat(f).toFixed(d.precision):parseFloat(f);break;case"g":f=d.precision?String(Number(f.toPrecision(d.precision))):parseFloat(f);break;case"o":f=(parseInt(f,10)>>>0).toString(8);break;case"s":f=String(f),f=d.precision?f.substring(0,d.precision):f;break;case"t":f=String(!!f),f=d.precision?f.substring(0,d.precision):f;break;case"T":f=Object.prototype.toString.call(f).slice(8,-1).toLowerCase(),f=d.precision?f.substring(0,d.precision):f;break;case"u":f=parseInt(f,10)>>>0;break;case"v":f=f.valueOf(),f=d.precision?f.substring(0,d.precision):f;break;case"x":f=(parseInt(f,10)>>>0).toString(16);break;case"X":f=(parseInt(f,10)>>>0).toString(16).toUpperCase();break}r.json.test(d.type)?w+=f:(r.number.test(d.type)&&(!B||d.sign)?(z=B?"+":"-",f=f.toString().replace(r.sign,"")):z="",M=d.pad_char?d.pad_char==="0"?"0":d.pad_char.charAt(1):" ",I=d.width-(z+f).length,A=d.width&&I>0?M.repeat(I):"",w+=d.align?z+f+A:M==="0"?z+A+f:A+z+f)}return w}var o=Object.create(null);function c(l){if(o[l])return o[l];for(var p=l,v,T=[],f=0;p;){if((v=r.text.exec(p))!==null)T.push(v[0]);else if((v=r.modulo.exec(p))!==null)T.push("%");else if((v=r.placeholder.exec(p))!==null){if(v[2]){f|=1;var w=[],y=v[2],g=[];if((g=r.key.exec(y))!==null)for(w.push(g[1]);(y=y.substring(g[0].length))!=="";)if((g=r.key_access.exec(y))!==null)w.push(g[1]);else if((g=r.index_access.exec(y))!==null)w.push(g[1]);else throw new SyntaxError("[sprintf] failed to parse named argument key");else throw new SyntaxError("[sprintf] failed to parse named argument key");v[2]=w}else f|=2;if(f===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");T.push({placeholder:v[0],param_no:v[1],keys:v[2],sign:v[3],pad_char:v[4],align:v[5],width:v[6],precision:v[7],type:v[8]})}else throw new SyntaxError("[sprintf] unexpected placeholder");p=p.substring(v[0].length)}return o[l]=T}typeof hr<"u"&&(hr.sprintf=t,hr.vsprintf=e),typeof window<"u"&&(window.sprintf=t,window.vsprintf=e,typeof define=="function"&&define.amd&&define(function(){return{sprintf:t,vsprintf:e}}))})()});var mi=V((Hm,di)=>{"use strict";function hi(r,t){for(let e in t)Object.defineProperty(r,e,{value:t[e],enumerable:!0,configurable:!0});return r}function Mf(r,t,e){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");e||(e={}),typeof t=="object"&&(e=t,t=""),t&&(e.code=t);try{return hi(r,e)}catch{e.message=r.message,e.stack=r.stack;let o=function(){};return o.prototype=Object.create(Object.getPrototypeOf(r)),hi(new o,e)}}di.exports=Mf});var Wf={};ct(Wf,{tcp:()=>Gf});var Ci=N(xt("net"),1);var X=xt("node:net");function pt(r){return!!(0,X.isIP)(r)}var Dr={};ct(Dr,{identity:()=>wc});function pc(r,t){if(r.length>=255)throw new TypeError("Alphabet too long");for(var e=new Uint8Array(256),n=0;n<e.length;n++)e[n]=255;for(var o=0;o<r.length;o++){var c=r.charAt(o),l=c.charCodeAt(0);if(e[l]!==255)throw new TypeError(c+" is ambiguous");e[l]=o}var p=r.length,v=r.charAt(0),T=Math.log(p)/Math.log(256),f=Math.log(256)/Math.log(p);function w(d){if(d instanceof Uint8Array||(ArrayBuffer.isView(d)?d=new Uint8Array(d.buffer,d.byteOffset,d.byteLength):Array.isArray(d)&&(d=Uint8Array.from(d))),!(d instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(d.length===0)return"";for(var A=0,M=0,I=0,B=d.length;I!==B&&d[I]===0;)I++,A++;for(var z=(B-I)*f+1>>>0,j=new Uint8Array(z);I!==B;){for(var st=d[I],nt=0,et=z-1;(st!==0||nt<M)&&et!==-1;et--,nt++)st+=256*j[et]>>>0,j[et]=st%p>>>0,st=st/p>>>0;if(st!==0)throw new Error("Non-zero carry");M=nt,I++}for(var ot=z-M;ot!==z&&j[ot]===0;)ot++;for(var gt=v.repeat(A);ot<z;++ot)gt+=r.charAt(j[ot]);return gt}function y(d){if(typeof d!="string")throw new TypeError("Expected String");if(d.length===0)return new Uint8Array;var A=0;if(d[A]!==" "){for(var M=0,I=0;d[A]===v;)M++,A++;for(var B=(d.length-A)*T+1>>>0,z=new Uint8Array(B);d[A];){var j=e[d.charCodeAt(A)];if(j===255)return;for(var st=0,nt=B-1;(j!==0||st<I)&&nt!==-1;nt--,st++)j+=p*z[nt]>>>0,z[nt]=j%256>>>0,j=j/256>>>0;if(j!==0)throw new Error("Non-zero carry");I=st,A++}if(d[A]!==" "){for(var et=B-I;et!==B&&z[et]===0;)et++;for(var ot=new Uint8Array(M+(B-et)),gt=M;et!==B;)ot[gt++]=z[et++];return ot}}}function g(d){var A=y(d);if(A)return A;throw new Error(`Non-${t} character`)}return{encode:w,decodeUnsafe:y,decode:g}}var hc=pc,dc=hc,mo=dc;var Xf=new Uint8Array(0);var go=(r,t)=>{if(r===t)return!0;if(r.byteLength!==t.byteLength)return!1;for(let e=0;e<r.byteLength;e++)if(r[e]!==t[e])return!1;return!0},ht=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")};var wo=r=>new TextEncoder().encode(r),bo=r=>new TextDecoder().decode(r);var Br=class{constructor(t,e,n){this.name=t,this.prefix=e,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},Rr=class{constructor(t,e,n){if(this.name=t,this.prefix=e,e.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=e.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return vo(this,t)}},Mr=class{constructor(t){this.decoders=t}or(t){return vo(this,t)}decode(t){let e=t[0],n=this.decoders[e];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},vo=(r,t)=>new Mr({...r.decoders||{[r.prefix]:r},...t.decoders||{[t.prefix]:t}}),Pr=class{constructor(t,e,n,o){this.name=t,this.prefix=e,this.baseEncode=n,this.baseDecode=o,this.encoder=new Br(t,e,n),this.decoder=new Rr(t,e,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}},te=({name:r,prefix:t,encode:e,decode:n})=>new Pr(r,t,e,n),Nt=({prefix:r,name:t,alphabet:e})=>{let{encode:n,decode:o}=mo(e,t);return te({prefix:r,name:t,encode:n,decode:c=>ht(o(c))})},mc=(r,t,e,n)=>{let o={};for(let f=0;f<t.length;++f)o[t[f]]=f;let c=r.length;for(;r[c-1]==="=";)--c;let l=new Uint8Array(c*e/8|0),p=0,v=0,T=0;for(let f=0;f<c;++f){let w=o[r[f]];if(w===void 0)throw new SyntaxError(`Non-${n} character`);v=v<<e|w,p+=e,p>=8&&(p-=8,l[T++]=255&v>>p)}if(p>=e||255&v<<8-p)throw new SyntaxError("Unexpected end of data");return l},gc=(r,t,e)=>{let n=t[t.length-1]==="=",o=(1<<e)-1,c="",l=0,p=0;for(let v=0;v<r.length;++v)for(p=p<<8|r[v],l+=8;l>e;)l-=e,c+=t[o&p>>l];if(l&&(c+=t[o&p<<e-l]),n)for(;c.length*e&7;)c+="=";return c},U=({name:r,prefix:t,bitsPerChar:e,alphabet:n})=>te({prefix:t,name:r,encode(o){return gc(o,n,e)},decode(o){return mc(o,n,e,r)}});var wc=te({prefix:"\0",name:"identity",encode:r=>bo(r),decode:r=>wo(r)});var Or={};ct(Or,{base2:()=>bc});var bc=U({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var _r={};ct(_r,{base8:()=>yc});var yc=U({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var kr={};ct(kr,{base10:()=>vc});var vc=Nt({prefix:"9",name:"base10",alphabet:"0123456789"});var Fr={};ct(Fr,{base16:()=>xc,base16upper:()=>Sc});var xc=U({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Sc=U({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Nr={};ct(Nr,{base32:()=>H,base32hex:()=>Ac,base32hexpad:()=>Bc,base32hexpadupper:()=>Rc,base32hexupper:()=>Ic,base32pad:()=>Ec,base32padupper:()=>Cc,base32upper:()=>Tc,base32z:()=>Mc});var H=U({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Tc=U({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Ec=U({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Cc=U({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Ac=U({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Ic=U({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Bc=U({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Rc=U({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Mc=U({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var $r={};ct($r,{base36:()=>Pc,base36upper:()=>Dc});var Pc=Nt({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Dc=Nt({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Ur={};ct(Ur,{base58btc:()=>k,base58flickr:()=>Oc});var k=Nt({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Oc=Nt({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var zr={};ct(zr,{base64:()=>Lr,base64pad:()=>_c,base64url:()=>kc,base64urlpad:()=>Fc});var Lr=U({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),_c=U({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),kc=U({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Fc=U({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Vr={};ct(Vr,{base256emoji:()=>zc});var xo=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Nc=xo.reduce((r,t,e)=>(r[e]=t,r),[]),$c=xo.reduce((r,t,e)=>(r[t.codePointAt(0)]=e,r),[]);function Uc(r){return r.reduce((t,e)=>(t+=Nc[e],t),"")}function Lc(r){let t=[];for(let e of r){let n=$c[e.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${e}`);t.push(n)}return new Uint8Array(t)}var zc=te({prefix:"\u{1F680}",name:"base256emoji",encode:Uc,decode:Lc});var Hr={};ct(Hr,{sha256:()=>iu,sha512:()=>au});var Wr=N(xt("crypto"),1);var Vc=Eo,So=128,jc=127,qc=~jc,Gc=Math.pow(2,31);function Eo(r,t,e){t=t||[],e=e||0;for(var n=e;r>=Gc;)t[e++]=r&255|So,r/=128;for(;r&qc;)t[e++]=r&255|So,r>>>=7;return t[e]=r|0,Eo.bytes=e-n+1,t}var Wc=jr,Hc=128,To=127;function jr(r,n){var e=0,n=n||0,o=0,c=n,l,p=r.length;do{if(c>=p)throw jr.bytes=0,new RangeError("Could not decode varint");l=r[c++],e+=o<28?(l&To)<<o:(l&To)*Math.pow(2,o),o+=7}while(l>=Hc);return jr.bytes=c-n,e}var Zc=Math.pow(2,7),Jc=Math.pow(2,14),Xc=Math.pow(2,21),Qc=Math.pow(2,28),Yc=Math.pow(2,35),Kc=Math.pow(2,42),tu=Math.pow(2,49),eu=Math.pow(2,56),ru=Math.pow(2,63),nu=function(r){return r<Zc?1:r<Jc?2:r<Xc?3:r<Qc?4:r<Yc?5:r<Kc?6:r<tu?7:r<eu?8:r<ru?9:10},ou={encode:Vc,decode:Wc,encodingLength:nu},su=ou,Se=su;var Te=(r,t=0)=>[Se.decode(r,t),Se.decode.bytes],ee=(r,t,e=0)=>(Se.encode(r,t,e),t),re=r=>Se.encodingLength(r);var Ht=(r,t)=>{let e=t.byteLength,n=re(r),o=n+re(e),c=new Uint8Array(o+e);return ee(r,c,0),ee(e,c,n),c.set(t,o),new ne(r,e,t,c)},$t=r=>{let t=ht(r),[e,n]=Te(t),[o,c]=Te(t.subarray(n)),l=t.subarray(n+c);if(l.byteLength!==o)throw new Error("Incorrect length");return new ne(e,o,l,t)},Co=(r,t)=>{if(r===t)return!0;{let e=t;return r.code===e.code&&r.size===e.size&&e.bytes instanceof Uint8Array&&go(r.bytes,e.bytes)}},ne=class{constructor(t,e,n,o){this.code=t,this.size=e,this.digest=n,this.bytes=o}};var Gr=({name:r,code:t,encode:e})=>new qr(r,t,e),qr=class{constructor(t,e,n){this.name=t,this.code=e,this.encode=n}digest(t){if(t instanceof Uint8Array){let e=this.encode(t);return e instanceof Uint8Array?Ht(this.code,e):e.then(n=>Ht(this.code,n))}else throw Error("Unknown type, must be binary type")}};var iu=Gr({name:"sha2-256",code:18,encode:r=>ht(Wr.default.createHash("sha256").update(r).digest())}),au=Gr({name:"sha2-512",code:19,encode:r=>ht(Wr.default.createHash("sha512").update(r).digest())});var Zr={};ct(Zr,{identity:()=>lu});var Io=0,cu="identity",Bo=ht,uu=r=>Ht(Io,Bo(r)),lu={code:Io,name:cu,encode:Bo,digest:uu};var bp=new TextEncoder,yp=new TextDecoder;var Ro=(r,t)=>{let{bytes:e,version:n}=r;switch(n){case 0:return du(e,Jr(r),t||k.encoder);default:return mu(e,Jr(r),t||H.encoder)}};var Mo=new WeakMap,Jr=r=>{let t=Mo.get(r);if(t==null){let e=new Map;return Mo.set(r,e),e}return t},R=class{constructor(t,e,n,o){this.code=e,this.version=t,this.multihash=n,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:t,multihash:e}=this;if(t!==Ee)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(e.code!==gu)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return R.createV0(e)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:t,digest:e}=this.multihash,n=Ht(t,e);return R.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return R.equals(this,t)}static equals(t,e){let n=e;return n&&t.code===n.code&&t.version===n.version&&Co(t.multihash,n.multihash)}toString(t){return Ro(this,t)}toJSON(){return{"/":Ro(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(t){if(t==null)return null;let e=t;if(e instanceof R)return e;if(e["/"]!=null&&e["/"]===e.bytes||e.asCID===e){let{version:n,code:o,multihash:c,bytes:l}=e;return new R(n,o,c,l||Po(n,o,c.bytes))}else if(e[wu]===!0){let{version:n,multihash:o,code:c}=e,l=$t(o);return R.create(n,c,l)}else return null}static create(t,e,n){if(typeof e!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:{if(e!==Ee)throw new Error(`Version 0 CID must use dag-pb (code: ${Ee}) block encoding`);return new R(t,e,n,n.bytes)}case 1:{let o=Po(t,e,n.bytes);return new R(t,e,n,o)}default:throw new Error("Invalid version")}}static createV0(t){return R.create(0,Ee,t)}static createV1(t,e){return R.create(1,t,e)}static decode(t){let[e,n]=R.decodeFirst(t);if(n.length)throw new Error("Incorrect length");return e}static decodeFirst(t){let e=R.inspectBytes(t),n=e.size-e.multihashSize,o=ht(t.subarray(n,n+e.multihashSize));if(o.byteLength!==e.multihashSize)throw new Error("Incorrect length");let c=o.subarray(e.multihashSize-e.digestSize),l=new ne(e.multihashCode,e.digestSize,c,o);return[e.version===0?R.createV0(l):R.createV1(e.codec,l),t.subarray(e.size)]}static inspectBytes(t){let e=0,n=()=>{let[w,y]=Te(t.subarray(e));return e+=y,w},o=n(),c=Ee;if(o===18?(o=0,e=0):c=n(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);let l=e,p=n(),v=n(),T=e+v,f=T-l;return{version:o,codec:c,multihashCode:p,digestSize:v,multihashSize:f,size:T}}static parse(t,e){let[n,o]=hu(t,e),c=R.decode(o);if(c.version===0&&t[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return Jr(c).set(n,t),c}},hu=(r,t)=>{switch(r[0]){case"Q":{let e=t||k;return[k.prefix,e.decode(`${k.prefix}${r}`)]}case k.prefix:{let e=t||k;return[k.prefix,e.decode(r)]}case H.prefix:{let e=t||H;return[H.prefix,e.decode(r)]}default:{if(t==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[r[0],t.decode(r)]}}},du=(r,t,e)=>{let{prefix:n}=e;if(n!==k.prefix)throw Error(`Cannot string encode V0 in ${e.name} encoding`);let o=t.get(n);if(o==null){let c=e.encode(r).slice(1);return t.set(n,c),c}else return o},mu=(r,t,e)=>{let{prefix:n}=e,o=t.get(n);if(o==null){let c=e.encode(r);return t.set(n,c),c}else return o},Ee=112,gu=18,Po=(r,t,e)=>{let n=re(r),o=n+re(t),c=new Uint8Array(o+e.byteLength);return ee(r,c,0),ee(t,c,n),c.set(e,o),c},wu=Symbol.for("@ipld/js-cid/CID");var It={...Dr,...Or,..._r,...kr,...Fr,...Nr,...$r,...Ur,...zr,...Vr},Rp={...Hr,...Zr};function oe(r){return globalThis.Buffer!=null?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function Ze(r=0){return globalThis.Buffer?.allocUnsafe!=null?oe(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}function Oo(r,t,e,n){return{name:r,prefix:t,encoder:{name:r,prefix:t,encode:e},decoder:{decode:n}}}var Do=Oo("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),Xr=Oo("ascii","a",r=>{let t="a";for(let e=0;e<r.length;e++)t+=String.fromCharCode(r[e]);return t},r=>{r=r.substring(1);let t=Ze(r.length);for(let e=0;e<r.length;e++)t[e]=r.charCodeAt(e);return t}),bu={utf8:Do,"utf-8":Do,hex:It.base16,latin1:Xr,ascii:Xr,binary:Xr,...It},Je=bu;function C(r,t="utf8"){let e=Je[t];if(e==null)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8"):e.encoder.encode(r).substring(1)}var _o=X.isIPv4,yu=X.isIPv6,Qr=function(r){let t=0;if(r=r.toString().trim(),_o(r)){let e=new Uint8Array(t+4);return r.split(/\./g).forEach(n=>{e[t++]=parseInt(n,10)&255}),e}if(yu(r)){let e=r.split(":",8),n;for(n=0;n<e.length;n++){let c=_o(e[n]),l;c&&(l=Qr(e[n]),e[n]=C(l.slice(0,2),"base16")),l!=null&&++n<8&&e.splice(n,0,C(l.slice(2,4),"base16"))}if(e[0]==="")for(;e.length<8;)e.unshift("0");else if(e[e.length-1]==="")for(;e.length<8;)e.push("0");else if(e.length<8){for(n=0;n<e.length&&e[n]!=="";n++);let c=[n,1];for(n=9-e.length;n>0;n--)c.push("0");e.splice.apply(e,c)}let o=new Uint8Array(t+16);for(n=0;n<e.length;n++){let c=parseInt(e[n],16);o[t++]=c>>8&255,o[t++]=c&255}return o}throw new Error("invalid ip address")},ko=function(r,t=0,e){t=~~t,e=e??r.length-t;let n=new DataView(r.buffer);if(e===4){let o=[];for(let c=0;c<e;c++)o.push(r[t+c]);return o.join(".")}if(e===16){let o=[];for(let c=0;c<e;c+=2)o.push(n.getUint16(t+c).toString(16));return o.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""};var Ce={},Yr={},xu=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,-1,"ip6zone"],[43,8,"ipcidr"],[53,-1,"dns",!0],[54,-1,"dns4",!0],[55,-1,"dns6",!0],[56,-1,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,-1,"unix",!1,!0],[421,-1,"ipfs"],[421,-1,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,-1,"garlic64"],[448,0,"tls"],[449,-1,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,-1,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,-1,"memory"]];xu.forEach(r=>{let t=Su(...r);Yr[t.code]=t,Ce[t.name]=t});function Su(r,t,e,n,o){return{code:r,size:t,name:e,resolvable:!!n,path:!!o}}function D(r){if(typeof r=="number"){if(Yr[r]!=null)return Yr[r];throw new Error(`no protocol with code: ${r}`)}else if(typeof r=="string"){if(Ce[r]!=null)return Ce[r];throw new Error(`no protocol with name: ${r}`)}throw new Error(`invalid protocol id type: ${typeof r}`)}var Tt=N(St(),1);function Bt(r,t="utf8"){let e=Je[t];if(e==null)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?oe(globalThis.Buffer.from(r,"utf-8")):e.decoder.decode(`${e.prefix}${r}`)}function P(r,t){t==null&&(t=r.reduce((o,c)=>o+c.length,0));let e=Ze(t),n=0;for(let o of r)e.set(o,n),n+=o.length;return oe(e)}var Xe=class{index=0;input="";new(t){return this.index=0,this.input=t,this}readAtomically(t){let e=this.index,n=t();return n===void 0&&(this.index=e),n}parseWith(t){let e=t();if(this.index===this.input.length)return e}peekChar(){if(!(this.index>=this.input.length))return this.input[this.index]}readChar(){if(!(this.index>=this.input.length))return this.input[this.index++]}readGivenChar(t){return this.readAtomically(()=>{let e=this.readChar();if(e===t)return e})}readSeparator(t,e,n){return this.readAtomically(()=>{if(!(e>0&&this.readGivenChar(t)===void 0))return n()})}readNumber(t,e,n,o){return this.readAtomically(()=>{let c=0,l=0,p=this.peekChar();if(p===void 0)return;let v=p==="0",T=2**(8*o)-1;for(;;){let f=this.readAtomically(()=>{let w=this.readChar();if(w===void 0)return;let y=Number.parseInt(w,t);if(!Number.isNaN(y))return y});if(f===void 0)break;if(c*=t,c+=f,c>T||(l+=1,e!==void 0&&l>e))return}if(l!==0)return!n&&v&&l>1?void 0:c})}readIPv4Addr(){return this.readAtomically(()=>{let t=new Uint8Array(4);for(let e=0;e<t.length;e++){let n=this.readSeparator(".",e,()=>this.readNumber(10,3,!1,1));if(n===void 0)return;t[e]=n}return t})}readIPv6Addr(){let t=e=>{for(let n=0;n<e.length/2;n++){let o=n*2;if(n<e.length-3){let l=this.readSeparator(":",n,()=>this.readIPv4Addr());if(l!==void 0)return e[o]=l[0],e[o+1]=l[1],e[o+2]=l[2],e[o+3]=l[3],[o+4,!0]}let c=this.readSeparator(":",n,()=>this.readNumber(16,4,!0,2));if(c===void 0)return[o,!1];e[o]=c>>8,e[o+1]=c&255}return[e.length,!1]};return this.readAtomically(()=>{let e=new Uint8Array(16),[n,o]=t(e);if(n===16)return e;if(o||this.readGivenChar(":")===void 0||this.readGivenChar(":")===void 0)return;let c=new Uint8Array(14),l=16-(n+2),[p]=t(c.subarray(0,l));return e.set(c.subarray(0,p),16-p),e})}readIPAddr(){return this.readIPv4Addr()??this.readIPv6Addr()}};var eh=new Xe;var uh=parseInt("0xFFFF",16),lh=new Uint8Array([0,0,0,0,0,0,0,0,0,0,255,255]);var jh=D("ip4"),qh=D("ip6"),Gh=D("ipcidr");function Xo(r,t){switch(D(r).code){case 4:case 41:return Vu(t);case 42:return Zo(t);case 6:case 273:case 33:case 132:return Yo(t).toString();case 53:case 54:case 55:case 56:case 400:case 449:case 777:return Zo(t);case 421:return Wu(t);case 444:return Jo(t);case 445:return Jo(t);case 466:return Gu(t);default:return C(t,"base16")}}function Qo(r,t){switch(D(r).code){case 4:return Wo(t);case 41:return Wo(t);case 42:return Ho(t);case 6:case 273:case 33:case 132:return nn(parseInt(t,10));case 53:case 54:case 55:case 56:case 400:case 449:case 777:return Ho(t);case 421:return ju(t);case 444:return Hu(t);case 445:return Zu(t);case 466:return qu(t);default:return Bt(t,"base16")}}var rn=Object.values(It).map(r=>r.decoder),zu=function(){let r=rn[0].or(rn[1]);return rn.slice(2).forEach(t=>r=r.or(t)),r}();function Wo(r){if(!pt(r))throw new Error("invalid ip address");return Qr(r)}function Vu(r){let t=ko(r,0,r.length);if(t==null)throw new Error("ipBuff is required");if(!pt(t))throw new Error("invalid ip address");return t}function nn(r){let t=new ArrayBuffer(2);return new DataView(t).setUint16(0,r),new Uint8Array(t)}function Yo(r){return new DataView(r.buffer).getUint16(r.byteOffset)}function Ho(r){let t=Bt(r),e=Uint8Array.from(Tt.default.encode(t.length));return P([e,t],e.length+t.length)}function Zo(r){let t=Tt.default.decode(r);if(r=r.slice(Tt.default.decode.bytes),r.length!==t)throw new Error("inconsistent lengths");return C(r)}function ju(r){let t;r[0]==="Q"||r[0]==="1"?t=$t(k.decode(`z${r}`)).bytes:t=R.parse(r).multihash.bytes;let e=Uint8Array.from(Tt.default.encode(t.length));return P([e,t],e.length+t.length)}function qu(r){let t=zu.decode(r),e=Uint8Array.from(Tt.default.encode(t.length));return P([e,t],e.length+t.length)}function Gu(r){let t=Tt.default.decode(r),e=r.slice(Tt.default.decode.bytes);if(e.length!==t)throw new Error("inconsistent lengths");return"u"+C(e,"base64url")}function Wu(r){let t=Tt.default.decode(r),e=r.slice(Tt.default.decode.bytes);if(e.length!==t)throw new Error("inconsistent lengths");return C(e,"base58btc")}function Hu(r){let t=r.split(":");if(t.length!==2)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(t[0].length!==16)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion address.`);let e=H.decode("b"+t[0]),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=nn(n);return P([e,o],e.length+o.length)}function Zu(r){let t=r.split(":");if(t.length!==2)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(t[0].length!==56)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion3 address.`);let e=H.decode(`b${t[0]}`),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=nn(n);return P([e,o],e.length+o.length)}function Jo(r){let t=r.slice(0,r.length-2),e=r.slice(r.length-2),n=C(t,"base32"),o=Yo(e);return`${n}:${o}`}var se=N(St(),1);function Ju(r){let t=[],e=r.split("/").slice(1);if(e.length===1&&e[0]==="")return[];for(let n=0;n<e.length;n++){let o=e[n],c=D(o);if(c.size===0){t.push([o]);continue}if(n++,n>=e.length)throw ts("invalid address: "+r);if(c.path===!0){t.push([o,un(e.slice(n).join("/"))]);break}t.push([o,e[n]])}return t}function Xu(r){let t=[];return r.map(e=>{let n=Ke(e);return t.push(n.name),e.length>1&&e[1]!=null&&t.push(e[1]),null}),un(t.join("/"))}function Qu(r){return r.map(t=>{Array.isArray(t)||(t=[t]);let e=Ke(t);return t.length>1?[e.code,Qo(e.code,t[1])]:[e.code]})}function on(r){return r.map(t=>{let e=Ke(t);return t[1]!=null?[e.code,Xo(e.code,t[1])]:[e.code]})}function sn(r){return Ye(P(r.map(t=>{let e=Ke(t),n=Uint8Array.from(se.default.encode(e.code));return t.length>1&&t[1]!=null&&(n=P([n,t[1]])),n})))}function an(r,t){return r.size>0?r.size/8:r.size===0?0:se.default.decode(t)+(se.default.decode.bytes??0)}function Qe(r){let t=[],e=0;for(;e<r.length;){let n=se.default.decode(r,e),o=se.default.decode.bytes??0,c=D(n),l=an(c,r.slice(e+o));if(l===0){t.push([n]),e+=o;continue}let p=r.slice(e+o,e+o+l);if(e+=l+o,e>r.length)throw ts("Invalid address Uint8Array: "+C(r,"base16"));t.push([n,p])}return t}function cn(r){let t=Qe(r),e=on(t);return Xu(e)}function Yu(r){r=un(r);let t=Ju(r),e=Qu(t);return sn(e)}function Ko(r){return Yu(r)}function Ye(r){let t=Ku(r);if(t!=null)throw t;return Uint8Array.from(r)}function Ku(r){try{Qe(r)}catch(t){return t}}function un(r){return"/"+r.trim().split("/").filter(t=>t).join("/")}function ts(r){return new Error("Error parsing address: "+r)}function Ke(r){return D(r[0])}var fn=N(St(),1);var Rt=class extends Error{constructor(t="The operation was aborted"){super(t),this.code=Rt.code,this.type=Rt.type}static get code(){return"ABORT_ERR"}static get type(){return"aborted"}},Q=class extends Error{constructor(t,e,n){super(t),this.code=e,this.name=n?.name??"CodeError",this.props=n??{}}};function ie(r,t){if(r===t)return!0;if(r.byteLength!==t.byteLength)return!1;for(let e=0;e<r.byteLength;e++)if(r[e]!==t[e])return!1;return!0}var ae=function(r,t,e,n){if(e==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?r!==t||!n:!t.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e==="m"?n:e==="a"?n.call(r):n?n.value:t.get(r)},ln=function(r,t,e,n,o){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!o)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?r!==t||!o:!t.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?o.call(r,e):o?o.value=e:t.set(r,e),e},Ae,Ie,Be,es,el=Symbol.for("nodejs.util.inspect.custom"),rl=[D("dns").code,D("dns4").code,D("dns6").code,D("dnsaddr").code],nl=new Map,rs=Symbol.for("@multiformats/js-multiaddr/multiaddr");function ol(r){return!!r?.[rs]}var Mt=class{constructor(t){if(Ae.set(this,void 0),Ie.set(this,void 0),Be.set(this,void 0),this[es]=!0,t==null&&(t=""),t instanceof Uint8Array)this.bytes=Ye(t);else if(typeof t=="string"){if(t.length>0&&t.charAt(0)!=="/")throw new Error(`multiaddr "${t}" must start with a "/"`);this.bytes=Ko(t)}else if(ol(t))this.bytes=Ye(t.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return ae(this,Ae,"f")==null&&ln(this,Ae,cn(this.bytes),"f"),ae(this,Ae,"f")}toJSON(){return this.toString()}toOptions(){let t,e,n,o,c="",l=D("tcp"),p=D("udp"),v=D("ip4"),T=D("ip6"),f=D("dns6"),w=D("ip6zone");for(let[g,d]of this.stringTuples())g===w.code&&(c=`%${d??""}`),rl.includes(g)&&(e=l.name,o=443,n=`${d??""}${c}`,t=g===f.code?6:4),(g===l.code||g===p.code)&&(e=D(g).name,o=parseInt(d??"")),(g===v.code||g===T.code)&&(e=D(g).name,n=`${d??""}${c}`,t=g===T.code?6:4);if(t==null||e==null||n==null||o==null)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:t,host:n,transport:e,port:o}}protos(){return this.protoCodes().map(t=>Object.assign({},D(t)))}protoCodes(){let t=[],e=this.bytes,n=0;for(;n<e.length;){let o=fn.default.decode(e,n),c=fn.default.decode.bytes??0,l=D(o),p=an(l,e.slice(n+c));n+=p+c,t.push(o)}return t}protoNames(){return this.protos().map(t=>t.name)}tuples(){return ae(this,Ie,"f")==null&&ln(this,Ie,Qe(this.bytes),"f"),ae(this,Ie,"f")}stringTuples(){return ae(this,Be,"f")==null&&ln(this,Be,on(this.tuples()),"f"),ae(this,Be,"f")}encapsulate(t){return t=new Mt(t),new Mt(this.toString()+t.toString())}decapsulate(t){let e=t.toString(),n=this.toString(),o=n.lastIndexOf(e);if(o<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${t.toString()}`);return new Mt(n.slice(0,o))}decapsulateCode(t){let e=this.tuples();for(let n=e.length-1;n>=0;n--)if(e[n][0]===t)return new Mt(sn(e.slice(0,n)));return this}getPeerId(){try{let e=this.stringTuples().filter(n=>n[0]===Ce.ipfs.code).pop();if(e?.[1]!=null){let n=e[1];return n[0]==="Q"||n[0]==="1"?C(k.decode(`z${n}`),"base58btc"):C(R.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){let t=null;try{t=this.stringTuples().filter(e=>D(e[0]).path===!0)[0][1],t==null&&(t=null)}catch{t=null}return t}equals(t){return ie(this.bytes,t.bytes)}async resolve(t){let e=this.protos().find(c=>c.resolvable);if(e==null)return[this];let n=nl.get(e.name);if(n==null)throw new Q(`no available resolver for ${e.name}`,"ERR_NO_AVAILABLE_RESOLVER");return(await n(this,t)).map(c=>new Mt(c))}nodeAddress(){let t=this.toOptions();if(t.transport!=="tcp"&&t.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${t.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:t.family,address:t.host,port:t.port}}isThinWaistAddress(t){let e=(t??this).protos();return!(e.length!==2||e[0].code!==4&&e[0].code!==41||e[1].code!==6&&e[1].code!==273)}[(Ae=new WeakMap,Ie=new WeakMap,Be=new WeakMap,es=rs,el)](){return`Multiaddr(${cn(this.bytes)})`}};function tr(r){return new Mt(r)}var sl=S("dns4"),il=S("dns6"),al=S("dnsaddr"),Zt=Z(S("dns"),al,sl,il),er=Z(S("ip4"),S("ip6")),zt=Z(E(er,S("tcp")),E(Zt,S("tcp"))),dn=E(er,S("udp")),cl=E(dn,S("utp")),ul=E(dn,S("quic")),Me=Z(E(zt,S("ws")),E(Zt,S("ws"))),Pe=Z(E(zt,S("wss")),E(Zt,S("wss")),E(zt,S("tls"),S("ws")),E(Zt,S("tls"),S("ws"))),pn=Z(E(zt,S("http")),E(er,S("http")),E(Zt,S("http"))),hn=Z(E(zt,S("https")),E(er,S("https")),E(Zt,S("https"))),ns=E(dn,S("webrtc"),S("certhash")),ss=Z(E(ns,S("p2p")),ns),is=Z(E(Me,S("p2p-webrtc-star"),S("p2p")),E(Pe,S("p2p-webrtc-star"),S("p2p")),E(Me,S("p2p-webrtc-star")),E(Pe,S("p2p-webrtc-star"))),hd=Z(E(Me,S("p2p-websocket-star"),S("p2p")),E(Pe,S("p2p-websocket-star"),S("p2p")),E(Me,S("p2p-websocket-star")),E(Pe,S("p2p-websocket-star"))),as=Z(E(pn,S("p2p-webrtc-direct"),S("p2p")),E(hn,S("p2p-webrtc-direct"),S("p2p")),E(pn,S("p2p-webrtc-direct")),E(hn,S("p2p-webrtc-direct"))),De=Z(Me,Pe,pn,hn,is,as,zt,cl,ul,Zt,ss),dd=Z(E(De,S("p2p-stardust"),S("p2p")),E(De,S("p2p-stardust"))),Lt=Z(E(De,S("p2p")),is,as,ss,S("p2p")),os=Z(E(Lt,S("p2p-circuit"),Lt),E(Lt,S("p2p-circuit")),E(S("p2p-circuit"),Lt),E(De,S("p2p-circuit")),E(S("p2p-circuit"),De),S("p2p-circuit")),cs=()=>Z(E(os,cs),os),Re=cs(),md=Z(E(Re,Lt,Re),E(Lt,Re),E(Re,Lt),Re,Lt);function us(r){function t(e){let n;try{n=tr(e)}catch{return!1}let o=r(n.protoNames());return o===null?!1:o===!0||o===!1?o:o.length===0}return t}function E(...r){function t(e){if(e.length<r.length)return null;let n=e;return r.some(o=>(n=typeof o=="function"?o().partialMatch(e):o.partialMatch(e),Array.isArray(n)&&(e=n),n===null)),n}return{toString:function(){return"{ "+r.join(" ")+" }"},input:r,matches:us(t),partialMatch:t}}function Z(...r){function t(n){let o=null;return r.some(c=>{let l=typeof c=="function"?c().partialMatch(n):c.partialMatch(n);return l!=null?(o=l,!0):!1}),o}return{toString:function(){return"{ "+r.join(" ")+" }"},input:r,matches:us(t),partialMatch:t}}function S(r){let t=r;function e(o){let c;try{c=tr(o)}catch{return!1}let l=c.protoNames();return l.length===1&&l[0]===t}function n(o){return o.length===0?null:o[0]===t?o.slice(1):null}return{toString:function(){return t},matches:e,partialMatch:n}}var mt=N(xs(),1);mt.default.formatters.b=r=>r==null?"undefined":k.baseEncode(r);mt.default.formatters.t=r=>r==null?"undefined":H.baseEncode(r);mt.default.formatters.m=r=>r==null?"undefined":Lr.baseEncode(r);mt.default.formatters.p=r=>r==null?"undefined":r.toString();mt.default.formatters.c=r=>r==null?"undefined":r.toString();mt.default.formatters.k=r=>r==null?"undefined":r.toString();function Ol(r){let t=()=>{};return t.enabled=!1,t.color="",t.diff=0,t.log=()=>{},t.namespace=r,t.destroy=()=>!0,t.extend=()=>t,t}function jt(r){let t=Ol(`${r}:trace`);return mt.default.enabled(`${r}:trace`)&&mt.default.names.map(e=>e.toString()).find(e=>e.includes(":trace"))!=null&&(t=(0,mt.default)(`${r}:trace`)),Object.assign((0,mt.default)(r),{error:(0,mt.default)(`${r}:error`),trace:t})}var xi=N(Rs(),1);var Ms=X.isIPv4,$l=X.isIPv6,xn=function(r){let t=0;if(r=r.toString().trim(),Ms(r)){let e=new Uint8Array(t+4);return r.split(/\./g).forEach(n=>{e[t++]=parseInt(n,10)&255}),e}if($l(r)){let e=r.split(":",8),n;for(n=0;n<e.length;n++){let c=Ms(e[n]),l;c&&(l=xn(e[n]),e[n]=C(l.slice(0,2),"base16")),l!=null&&++n<8&&e.splice(n,0,C(l.slice(2,4),"base16"))}if(e[0]==="")for(;e.length<8;)e.unshift("0");else if(e[e.length-1]==="")for(;e.length<8;)e.push("0");else if(e.length<8){for(n=0;n<e.length&&e[n]!=="";n++);let c=[n,1];for(n=9-e.length;n>0;n--)c.push("0");e.splice.apply(e,c)}let o=new Uint8Array(t+16);for(n=0;n<e.length;n++){let c=parseInt(e[n],16);o[t++]=c>>8&255,o[t++]=c&255}return o}throw new Error("invalid ip address")},Ps=function(r,t=0,e){t=~~t,e=e??r.length-t;let n=new DataView(r.buffer);if(e===4){let o=[];for(let c=0;c<e;c++)o.push(r[t+c]);return o.join(".")}if(e===16){let o=[];for(let c=0;c<e;c+=2)o.push(n.getUint16(t+c).toString(16));return o.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""};var Oe={},Sn={},Ll=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,-1,"ip6zone"],[43,8,"ipcidr"],[53,-1,"dns",!0],[54,-1,"dns4",!0],[55,-1,"dns6",!0],[56,-1,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,-1,"unix",!1,!0],[421,-1,"ipfs"],[421,-1,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,-1,"garlic64"],[448,0,"tls"],[449,-1,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,-1,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,-1,"memory"]];Ll.forEach(r=>{let t=zl(...r);Sn[t.code]=t,Oe[t.name]=t});function zl(r,t,e,n,o){return{code:r,size:t,name:e,resolvable:!!n,path:!!o}}function O(r){if(typeof r=="number"){if(Sn[r]!=null)return Sn[r];throw new Error(`no protocol with code: ${r}`)}else if(typeof r=="string"){if(Oe[r]!=null)return Oe[r];throw new Error(`no protocol with name: ${r}`)}throw new Error(`invalid protocol id type: ${typeof r}`)}var Et=N(St(),1);var qd=O("ip4"),Gd=O("ip6"),Wd=O("ipcidr");function Fs(r,t){switch(O(r).code){case 4:case 41:return jl(t);case 42:return _s(t);case 6:case 273:case 33:case 132:return $s(t).toString();case 53:case 54:case 55:case 56:case 400:case 449:case 777:return _s(t);case 421:return Hl(t);case 444:return ks(t);case 445:return ks(t);case 466:return Wl(t);default:return C(t,"base16")}}function Ns(r,t){switch(O(r).code){case 4:return Ds(t);case 41:return Ds(t);case 42:return Os(t);case 6:case 273:case 33:case 132:return En(parseInt(t,10));case 53:case 54:case 55:case 56:case 400:case 449:case 777:return Os(t);case 421:return ql(t);case 444:return Zl(t);case 445:return Jl(t);case 466:return Gl(t);default:return Bt(t,"base16")}}var Tn=Object.values(It).map(r=>r.decoder),Vl=function(){let r=Tn[0].or(Tn[1]);return Tn.slice(2).forEach(t=>r=r.or(t)),r}();function Ds(r){if(!pt(r))throw new Error("invalid ip address");return xn(r)}function jl(r){let t=Ps(r,0,r.length);if(t==null)throw new Error("ipBuff is required");if(!pt(t))throw new Error("invalid ip address");return t}function En(r){let t=new ArrayBuffer(2);return new DataView(t).setUint16(0,r),new Uint8Array(t)}function $s(r){return new DataView(r.buffer).getUint16(r.byteOffset)}function Os(r){let t=Bt(r),e=Uint8Array.from(Et.default.encode(t.length));return P([e,t],e.length+t.length)}function _s(r){let t=Et.default.decode(r);if(r=r.slice(Et.default.decode.bytes),r.length!==t)throw new Error("inconsistent lengths");return C(r)}function ql(r){let t;r[0]==="Q"||r[0]==="1"?t=$t(k.decode(`z${r}`)).bytes:t=R.parse(r).multihash.bytes;let e=Uint8Array.from(Et.default.encode(t.length));return P([e,t],e.length+t.length)}function Gl(r){let t=Vl.decode(r),e=Uint8Array.from(Et.default.encode(t.length));return P([e,t],e.length+t.length)}function Wl(r){let t=Et.default.decode(r),e=r.slice(Et.default.decode.bytes);if(e.length!==t)throw new Error("inconsistent lengths");return"u"+C(e,"base64url")}function Hl(r){let t=Et.default.decode(r),e=r.slice(Et.default.decode.bytes);if(e.length!==t)throw new Error("inconsistent lengths");return C(e,"base58btc")}function Zl(r){let t=r.split(":");if(t.length!==2)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(t[0].length!==16)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion address.`);let e=H.decode("b"+t[0]),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=En(n);return P([e,o],e.length+o.length)}function Jl(r){let t=r.split(":");if(t.length!==2)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(t[0].length!==56)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion3 address.`);let e=H.decode(`b${t[0]}`),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=En(n);return P([e,o],e.length+o.length)}function ks(r){let t=r.slice(0,r.length-2),e=r.slice(r.length-2),n=C(t,"base32"),o=$s(e);return`${n}:${o}`}var pe=N(St(),1);function Xl(r){let t=[],e=r.split("/").slice(1);if(e.length===1&&e[0]==="")return[];for(let n=0;n<e.length;n++){let o=e[n],c=O(o);if(c.size===0){t.push([o]);continue}if(n++,n>=e.length)throw Ls("invalid address: "+r);if(c.path===!0){t.push([o,Rn(e.slice(n).join("/"))]);break}t.push([o,e[n]])}return t}function Ql(r){let t=[];return r.map(e=>{let n=ur(e);return t.push(n.name),e.length>1&&e[1]!=null&&t.push(e[1]),null}),Rn(t.join("/"))}function Yl(r){return r.map(t=>{Array.isArray(t)||(t=[t]);let e=ur(t);return t.length>1?[e.code,Ns(e.code,t[1])]:[e.code]})}function Cn(r){return r.map(t=>{let e=ur(t);return t[1]!=null?[e.code,Fs(e.code,t[1])]:[e.code]})}function An(r){return cr(P(r.map(t=>{let e=ur(t),n=Uint8Array.from(pe.default.encode(e.code));return t.length>1&&t[1]!=null&&(n=P([n,t[1]])),n})))}function In(r,t){return r.size>0?r.size/8:r.size===0?0:pe.default.decode(t)+(pe.default.decode.bytes??0)}function ar(r){let t=[],e=0;for(;e<r.length;){let n=pe.default.decode(r,e),o=pe.default.decode.bytes??0,c=O(n),l=In(c,r.slice(e+o));if(l===0){t.push([n]),e+=o;continue}let p=r.slice(e+o,e+o+l);if(e+=l+o,e>r.length)throw Ls("Invalid address Uint8Array: "+C(r,"base16"));t.push([n,p])}return t}function Bn(r){let t=ar(r),e=Cn(t);return Ql(e)}function Kl(r){r=Rn(r);let t=Xl(r),e=Yl(t);return An(e)}function Us(r){return Kl(r)}function cr(r){let t=tf(r);if(t!=null)throw t;return Uint8Array.from(r)}function tf(r){try{ar(r)}catch(t){return t}}function Rn(r){return"/"+r.trim().split("/").filter(t=>t).join("/")}function Ls(r){return new Error("Error parsing address: "+r)}function ur(r){return O(r[0])}var Pn=N(St(),1);var he=function(r,t,e,n){if(e==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?r!==t||!n:!t.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e==="m"?n:e==="a"?n.call(r):n?n.value:t.get(r)},Mn=function(r,t,e,n,o){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!o)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?r!==t||!o:!t.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?o.call(r,e):o?o.value=e:t.set(r,e),e},ke,Fe,Ne,zs,rf=Symbol.for("nodejs.util.inspect.custom"),nf=[O("dns").code,O("dns4").code,O("dns6").code,O("dnsaddr").code],of=new Map,Vs=Symbol.for("@multiformats/js-multiaddr/multiaddr");function sf(r){return!!r?.[Vs]}var Pt=class{constructor(t){if(ke.set(this,void 0),Fe.set(this,void 0),Ne.set(this,void 0),this[zs]=!0,t==null&&(t=""),t instanceof Uint8Array)this.bytes=cr(t);else if(typeof t=="string"){if(t.length>0&&t.charAt(0)!=="/")throw new Error(`multiaddr "${t}" must start with a "/"`);this.bytes=Us(t)}else if(sf(t))this.bytes=cr(t.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return he(this,ke,"f")==null&&Mn(this,ke,Bn(this.bytes),"f"),he(this,ke,"f")}toJSON(){return this.toString()}toOptions(){let t,e,n,o,c="",l=O("tcp"),p=O("udp"),v=O("ip4"),T=O("ip6"),f=O("dns6"),w=O("ip6zone");for(let[g,d]of this.stringTuples())g===w.code&&(c=`%${d??""}`),nf.includes(g)&&(e=l.name,o=443,n=`${d??""}${c}`,t=g===f.code?6:4),(g===l.code||g===p.code)&&(e=O(g).name,o=parseInt(d??"")),(g===v.code||g===T.code)&&(e=O(g).name,n=`${d??""}${c}`,t=g===T.code?6:4);if(t==null||e==null||n==null||o==null)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:t,host:n,transport:e,port:o}}protos(){return this.protoCodes().map(t=>Object.assign({},O(t)))}protoCodes(){let t=[],e=this.bytes,n=0;for(;n<e.length;){let o=Pn.default.decode(e,n),c=Pn.default.decode.bytes??0,l=O(o),p=In(l,e.slice(n+c));n+=p+c,t.push(o)}return t}protoNames(){return this.protos().map(t=>t.name)}tuples(){return he(this,Fe,"f")==null&&Mn(this,Fe,ar(this.bytes),"f"),he(this,Fe,"f")}stringTuples(){return he(this,Ne,"f")==null&&Mn(this,Ne,Cn(this.tuples()),"f"),he(this,Ne,"f")}encapsulate(t){return t=new Pt(t),new Pt(this.toString()+t.toString())}decapsulate(t){let e=t.toString(),n=this.toString(),o=n.lastIndexOf(e);if(o<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${t.toString()}`);return new Pt(n.slice(0,o))}decapsulateCode(t){let e=this.tuples();for(let n=e.length-1;n>=0;n--)if(e[n][0]===t)return new Pt(An(e.slice(0,n)));return this}getPeerId(){try{let e=this.stringTuples().filter(n=>n[0]===Oe.ipfs.code).pop();if(e?.[1]!=null){let n=e[1];return n[0]==="Q"||n[0]==="1"?C(k.decode(`z${n}`),"base58btc"):C(R.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){let t=null;try{t=this.stringTuples().filter(e=>O(e[0]).path===!0)[0][1],t==null&&(t=null)}catch{t=null}return t}equals(t){return ie(this.bytes,t.bytes)}async resolve(t){let e=this.protos().find(c=>c.resolvable);if(e==null)return[this];let n=of.get(e.name);if(n==null)throw new Q(`no available resolver for ${e.name}`,"ERR_NO_AVAILABLE_RESOLVER");return(await n(this,t)).map(c=>new Pt(c))}nodeAddress(){let t=this.toOptions();if(t.transport!=="tcp"&&t.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${t.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:t.family,address:t.host,port:t.port}}isThinWaistAddress(t){let e=(t??this).protos();return!(e.length!==2||e[0].code!==4&&e[0].code!==41||e[1].code!==6&&e[1].code!==273)}[(ke=new WeakMap,Fe=new WeakMap,Ne=new WeakMap,zs=Vs,rf)](){return`Multiaddr(${Bn(this.bytes)})`}};function _e(r){return new Pt(r)}function lr(r){return this.subnetMask<r.subnetMask?!1:this.mask(r.subnetMask)===r.mask()}function fr(r){return function(){return this.addressMinusSuffix!==this.correctForm()?!1:this.subnetMask===r&&!this.parsedSubnet?!0:this.parsedSubnet===String(this.subnetMask)}}var de=/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/g,Dn=/\/\d{1,2}$/;var Y=class extends Error{constructor(t,e){super(t),this.name="AddressError",e!==null&&(this.parseMessage=e)}};var me=N(On(),1),Xt=N($e(),1),F=class{constructor(t){this.groups=4,this.parsedAddress=[],this.parsedSubnet="",this.subnet="/32",this.subnetMask=32,this.v4=!0,this.isCorrect=fr(32),this.isInSubnet=lr,this.address=t;let e=Dn.exec(t);if(e){if(this.parsedSubnet=e[0].replace("/",""),this.subnetMask=parseInt(this.parsedSubnet,10),this.subnet=`/${this.subnetMask}`,this.subnetMask<0||this.subnetMask>32)throw new Y("Invalid subnet mask.");t=t.replace(Dn,"")}this.addressMinusSuffix=t,this.parsedAddress=this.parse(t)}static isValid(t){try{return new F(t),!0}catch{return!1}}parse(t){let e=t.split(".");if(!t.match(de))throw new Y("Invalid IPv4 address.");return e}correctForm(){return this.parsedAddress.map(t=>parseInt(t,10)).join(".")}static fromHex(t){let e=t.replace(/:/g,"").padStart(8,"0"),n=[],o;for(o=0;o<8;o+=2){let c=e.slice(o,o+2);n.push(parseInt(c,16))}return new F(n.join("."))}static fromInteger(t){return F.fromHex(t.toString(16))}static fromArpa(t){let n=t.replace(/(\.in-addr\.arpa)?\.$/,"").split(".").reverse().join(".");return new F(n)}toHex(){return this.parsedAddress.map(t=>(0,Xt.sprintf)("%02x",parseInt(t,10))).join(":")}toArray(){return this.parsedAddress.map(t=>parseInt(t,10))}toGroup6(){let t=[],e;for(e=0;e<4;e+=2){let n=(0,Xt.sprintf)("%02x%02x",parseInt(this.parsedAddress[e],10),parseInt(this.parsedAddress[e+1],10));t.push((0,Xt.sprintf)("%x",parseInt(n,16)))}return t.join(":")}bigInteger(){return new me.BigInteger(this.parsedAddress.map(t=>(0,Xt.sprintf)("%02x",parseInt(t,10))).join(""),16)}_startAddress(){return new me.BigInteger(this.mask()+"0".repeat(32-this.subnetMask),2)}startAddress(){return F.fromBigInteger(this._startAddress())}startAddressExclusive(){let t=new me.BigInteger("1");return F.fromBigInteger(this._startAddress().add(t))}_endAddress(){return new me.BigInteger(this.mask()+"1".repeat(32-this.subnetMask),2)}endAddress(){return F.fromBigInteger(this._endAddress())}endAddressExclusive(){let t=new me.BigInteger("1");return F.fromBigInteger(this._endAddress().subtract(t))}static fromBigInteger(t){return F.fromInteger(parseInt(t.toString(),10))}mask(t){return t===void 0&&(t=this.subnetMask),this.getBitsBase2(0,t)}getBitsBase2(t,e){return this.binaryZeroPad().slice(t,e)}reverseForm(t){t||(t={});let e=this.correctForm().split(".").reverse().join(".");return t.omitSuffix?e:(0,Xt.sprintf)("%s.in-addr.arpa.",e)}isMulticast(){return this.isInSubnet(new F("224.0.0.0/4"))}binaryZeroPad(){return this.bigInteger().toString(2).padStart(32,"0")}groupForV6(){let t=this.parsedAddress;return this.address.replace(de,(0,Xt.sprintf)('<span class="hover-group group-v4 group-6">%s</span>.<span class="hover-group group-v4 group-7">%s</span>',t.slice(0,2).join("."),t.slice(2,4).join(".")))}};var Hs={0:"Reserved",1:"Interface local",2:"Link local",4:"Admin local",5:"Site local",8:"Organization local",14:"Global",15:"Reserved"},_n={"ff01::1/128":"Multicast (All nodes on this interface)","ff01::2/128":"Multicast (All routers on this interface)","ff02::1/128":"Multicast (All nodes on this link)","ff02::2/128":"Multicast (All routers on this link)","ff05::2/128":"Multicast (All routers in this site)","ff02::5/128":"Multicast (OSPFv3 AllSPF routers)","ff02::6/128":"Multicast (OSPFv3 AllDR routers)","ff02::9/128":"Multicast (RIP routers)","ff02::a/128":"Multicast (EIGRP routers)","ff02::d/128":"Multicast (PIM routers)","ff02::16/128":"Multicast (MLDv2 reports)","ff01::fb/128":"Multicast (mDNSv6)","ff02::fb/128":"Multicast (mDNSv6)","ff05::fb/128":"Multicast (mDNSv6)","ff02::1:2/128":"Multicast (All DHCP servers and relay agents on this link)","ff05::1:2/128":"Multicast (All DHCP servers and relay agents in this site)","ff02::1:3/128":"Multicast (All DHCP servers on this link)","ff05::1:3/128":"Multicast (All DHCP servers in this site)","::/128":"Unspecified","::1/128":"Loopback","ff00::/8":"Multicast","fe80::/10":"Link-local unicast"},kn=/([^0-9a-f:/%])/gi,Fn=/([0-9a-f]{5,}|:{3,}|[^:]:$|^:[^:]|\/$)/gi,Nn=/\/\d{1,3}(?=%|$)/,$n=/%.*$/,Zs=new RegExp(/^\[{0,1}([0-9a-f:]+)\]{0,1}/),Js=new RegExp(/\[([0-9a-f:]+)\]:([0-9]{1,5})/);var Qs=N($e(),1);function af(r){return r.replace(/^(0+)/,'<span class="zero">$1</span>')}function dr(r,t=0){return r.split(":").map((n,o)=>/group-v4/.test(n)?n:(0,Qs.sprintf)('<span class="hover-group group-%d">%s</span>',o+t,af(n)))}var Yt=N($e(),1);function Ln(r){return(0,Yt.sprintf)("(%s)",r.join("|"))}function Un(r){return r.length<4?(0,Yt.sprintf)("0{0,%d}%s",4-r.length,r):r}var zn="[^A-Fa-f0-9:]";function mr(r){let t=[];r.forEach((n,o)=>{parseInt(n,16)===0&&t.push(o)});let e=t.map(n=>r.map((o,c)=>{if(c===n){let l=c===0||c===8-1?":":"";return Ln([Un(o),l])}return Un(o)}).join(":"));return e.push(r.map(Un).join(":")),Ln(e)}function Vn(r,t,e){let n=t?"":":",o=e?"":":",c=[];!t&&!e&&c.push("::"),t&&e&&c.push(""),(e&&!t||!e&&t)&&c.push(":"),c.push((0,Yt.sprintf)("%s(:0{1,4}){1,%d}",n,r-1)),c.push((0,Yt.sprintf)("(0{1,4}:){1,%d}%s",r-1,o)),c.push((0,Yt.sprintf)("(0{1,4}:){%d}0{1,4}",r-1));for(let l=1;l<r-1;l++)for(let p=1;p<r-l;p++)c.push((0,Yt.sprintf)("(0{1,4}:){%d}:(0{1,4}:){%d}0{1,4}",p,r-p-l-1));return Ln(c)}var K=N(On(),1),tt=N($e(),1);function gr(r){if(!r)throw new Error("Assertion failed.")}function cf(r){let t=/(\d+)(\d{3})/;for(;t.test(r);)r=r.replace(t,"$1,$2");return r}function uf(r){return r=r.replace(/^(0{1,})([1-9]+)$/,'<span class="parse-error">$1</span>$2'),r=r.replace(/^(0{1,})(0)$/,'<span class="parse-error">$1</span>$2'),r}function lf(r,t){let e=[],n=[],o;for(o=0;o<r.length;o++)o<t[0]?e.push(r[o]):o>t[1]&&n.push(r[o]);return e.concat(["compact"]).concat(n)}function Ks(r){return(0,tt.sprintf)("%04x",parseInt(r,16))}function ti(r){return r&255}var L=class{constructor(t,e){this.addressMinusSuffix="",this.parsedSubnet="",this.subnet="/128",this.subnetMask=128,this.v4=!1,this.zone="",this.isInSubnet=lr,this.isCorrect=fr(128),e===void 0?this.groups=8:this.groups=e,this.address=t;let n=Nn.exec(t);if(n){if(this.parsedSubnet=n[0].replace("/",""),this.subnetMask=parseInt(this.parsedSubnet,10),this.subnet=`/${this.subnetMask}`,Number.isNaN(this.subnetMask)||this.subnetMask<0||this.subnetMask>128)throw new Y("Invalid subnet mask.");t=t.replace(Nn,"")}else if(/\//.test(t))throw new Y("Invalid subnet mask.");let o=$n.exec(t);o&&(this.zone=o[0],t=t.replace($n,"")),this.addressMinusSuffix=t,this.parsedAddress=this.parse(this.addressMinusSuffix)}static isValid(t){try{return new L(t),!0}catch{return!1}}static fromBigInteger(t){let e=t.toString(16).padStart(32,"0"),n=[],o;for(o=0;o<8;o++)n.push(e.slice(o*4,(o+1)*4));return new L(n.join(":"))}static fromURL(t){let e,n=null,o;if(t.indexOf("[")!==-1&&t.indexOf("]:")!==-1){if(o=Js.exec(t),o===null)return{error:"failed to parse address with port",address:null,port:null};e=o[1],n=o[2]}else if(t.indexOf("/")!==-1){if(t=t.replace(/^[a-z0-9]+:\/\//,""),o=Zs.exec(t),o===null)return{error:"failed to parse address from URL",address:null,port:null};e=o[1]}else e=t;return n?(n=parseInt(n,10),(n<0||n>65536)&&(n=null)):n=null,{address:new L(e),port:n}}static fromAddress4(t){let e=new F(t),n=128-(32-e.subnetMask);return new L(`::ffff:${e.correctForm()}/${n}`)}static fromArpa(t){let e=t.replace(/(\.ip6\.arpa)?\.$/,""),n=7;if(e.length!==63)throw new Y("Invalid 'ip6.arpa' form.");let o=e.split(".").reverse();for(let c=n;c>0;c--){let l=c*4;o.splice(l,0,":")}return e=o.join(""),new L(e)}microsoftTranscription(){return(0,tt.sprintf)("%s.ipv6-literal.net",this.correctForm().replace(/:/g,"-"))}mask(t=this.subnetMask){return this.getBitsBase2(0,t)}possibleSubnets(t=128){let e=128-this.subnetMask,n=Math.abs(t-128),o=e-n;return o<0?"0":cf(new K.BigInteger("2",10).pow(o).toString(10))}_startAddress(){return new K.BigInteger(this.mask()+"0".repeat(128-this.subnetMask),2)}startAddress(){return L.fromBigInteger(this._startAddress())}startAddressExclusive(){let t=new K.BigInteger("1");return L.fromBigInteger(this._startAddress().add(t))}_endAddress(){return new K.BigInteger(this.mask()+"1".repeat(128-this.subnetMask),2)}endAddress(){return L.fromBigInteger(this._endAddress())}endAddressExclusive(){let t=new K.BigInteger("1");return L.fromBigInteger(this._endAddress().subtract(t))}getScope(){let t=Hs[this.getBits(12,16).intValue()];return this.getType()==="Global unicast"&&t!=="Link local"&&(t="Global"),t||"Unknown"}getType(){for(let t of Object.keys(_n))if(this.isInSubnet(new L(t)))return _n[t];return"Global unicast"}getBits(t,e){return new K.BigInteger(this.getBitsBase2(t,e),2)}getBitsBase2(t,e){return this.binaryZeroPad().slice(t,e)}getBitsBase16(t,e){let n=e-t;if(n%4!==0)throw new Error("Length of bits to retrieve must be divisible by four");return this.getBits(t,e).toString(16).padStart(n/4,"0")}getBitsPastSubnet(){return this.getBitsBase2(this.subnetMask,128)}reverseForm(t){t||(t={});let e=Math.floor(this.subnetMask/4),n=this.canonicalForm().replace(/:/g,"").split("").slice(0,e).reverse().join(".");return e>0?t.omitSuffix?n:(0,tt.sprintf)("%s.ip6.arpa.",n):t.omitSuffix?"":"ip6.arpa."}correctForm(){let t,e=[],n=0,o=[];for(t=0;t<this.parsedAddress.length;t++){let p=parseInt(this.parsedAddress[t],16);p===0&&n++,p!==0&&n>0&&(n>1&&o.push([t-n,t-1]),n=0)}n>1&&o.push([this.parsedAddress.length-n,this.parsedAddress.length-1]);let c=o.map(p=>p[1]-p[0]+1);if(o.length>0){let p=c.indexOf(Math.max(...c));e=lf(this.parsedAddress,o[p])}else e=this.parsedAddress;for(t=0;t<e.length;t++)e[t]!=="compact"&&(e[t]=parseInt(e[t],16).toString(16));let l=e.join(":");return l=l.replace(/^compact$/,"::"),l=l.replace(/^compact|compact$/,":"),l=l.replace(/compact/,""),l}binaryZeroPad(){return this.bigInteger().toString(2).padStart(128,"0")}parse4in6(t){let e=t.split(":"),o=e.slice(-1)[0].match(de);if(o){this.parsedAddress4=o[0],this.address4=new F(this.parsedAddress4);for(let c=0;c<this.address4.groups;c++)if(/^0[0-9]+/.test(this.address4.parsedAddress[c]))throw new Y("IPv4 addresses can't have leading zeroes.",t.replace(de,this.address4.parsedAddress.map(uf).join(".")));this.v4=!0,e[e.length-1]=this.address4.toGroup6(),t=e.join(":")}return t}parse(t){t=this.parse4in6(t);let e=t.match(kn);if(e)throw new Y((0,tt.sprintf)("Bad character%s detected in address: %s",e.length>1?"s":"",e.join("")),t.replace(kn,'<span class="parse-error">$1</span>'));let n=t.match(Fn);if(n)throw new Y((0,tt.sprintf)("Address failed regex: %s",n.join("")),t.replace(Fn,'<span class="parse-error">$1</span>'));let o=[],c=t.split("::");if(c.length===2){let l=c[0].split(":"),p=c[1].split(":");l.length===1&&l[0]===""&&(l=[]),p.length===1&&p[0]===""&&(p=[]);let v=this.groups-(l.length+p.length);if(!v)throw new Y("Error parsing groups");this.elidedGroups=v,this.elisionBegin=l.length,this.elisionEnd=l.length+this.elidedGroups,o=o.concat(l);for(let T=0;T<v;T++)o.push("0");o=o.concat(p)}else if(c.length===1)o=t.split(":"),this.elidedGroups=0;else throw new Y("Too many :: groups found");if(o=o.map(l=>(0,tt.sprintf)("%x",parseInt(l,16))),o.length!==this.groups)throw new Y("Incorrect number of groups found");return o}canonicalForm(){return this.parsedAddress.map(Ks).join(":")}decimal(){return this.parsedAddress.map(t=>(0,tt.sprintf)("%05d",parseInt(t,16))).join(":")}bigInteger(){return new K.BigInteger(this.parsedAddress.map(Ks).join(""),16)}to4(){let t=this.binaryZeroPad().split("");return F.fromHex(new K.BigInteger(t.slice(96,128).join(""),2).toString(16))}to4in6(){let t=this.to4(),n=new L(this.parsedAddress.slice(0,6).join(":"),6).correctForm(),o="";return/:$/.test(n)||(o=":"),n+o+t.address}inspectTeredo(){let t=this.getBitsBase16(0,32),e=this.getBits(80,96).xor(new K.BigInteger("ffff",16)).toString(),n=F.fromHex(this.getBitsBase16(32,64)),o=F.fromHex(this.getBits(96,128).xor(new K.BigInteger("ffffffff",16)).toString(16)),c=this.getBits(64,80),l=this.getBitsBase2(64,80),p=c.testBit(15),v=c.testBit(14),T=c.testBit(8),f=c.testBit(9),w=new K.BigInteger(l.slice(2,6)+l.slice(8,16),2).toString(10);return{prefix:(0,tt.sprintf)("%s:%s",t.slice(0,4),t.slice(4,8)),server4:n.address,client4:o.address,flags:l,coneNat:p,microsoft:{reserved:v,universalLocal:f,groupIndividual:T,nonce:w},udpPort:e}}inspect6to4(){let t=this.getBitsBase16(0,16),e=F.fromHex(this.getBitsBase16(16,48));return{prefix:(0,tt.sprintf)("%s",t.slice(0,4)),gateway:e.address}}to6to4(){if(!this.is4())return null;let t=["2002",this.getBitsBase16(96,112),this.getBitsBase16(112,128),"","/16"].join(":");return new L(t)}toByteArray(){let t=this.bigInteger().toByteArray();return t.length===17&&t[0]===0?t.slice(1):t}toUnsignedByteArray(){return this.toByteArray().map(ti)}static fromByteArray(t){return this.fromUnsignedByteArray(t.map(ti))}static fromUnsignedByteArray(t){let e=new K.BigInteger("256",10),n=new K.BigInteger("0",10),o=new K.BigInteger("1",10);for(let c=t.length-1;c>=0;c--)n=n.add(o.multiply(new K.BigInteger(t[c].toString(10),10))),o=o.multiply(e);return L.fromBigInteger(n)}isCanonical(){return this.addressMinusSuffix===this.canonicalForm()}isLinkLocal(){return this.getBitsBase2(0,64)==="1111111010000000000000000000000000000000000000000000000000000000"}isMulticast(){return this.getType()==="Multicast"}is4(){return this.v4}isTeredo(){return this.isInSubnet(new L("2001::/32"))}is6to4(){return this.isInSubnet(new L("2002::/16"))}isLoopback(){return this.getType()==="Loopback"}href(t){return t===void 0?t="":t=(0,tt.sprintf)(":%s",t),(0,tt.sprintf)("http://[%s]%s/",this.correctForm(),t)}link(t){t||(t={}),t.className===void 0&&(t.className=""),t.prefix===void 0&&(t.prefix="/#address="),t.v4===void 0&&(t.v4=!1);let e=this.correctForm;return t.v4&&(e=this.to4in6),t.className?(0,tt.sprintf)('<a href="%1$s%2$s" class="%3$s">%2$s</a>',t.prefix,e.call(this),t.className):(0,tt.sprintf)('<a href="%1$s%2$s">%2$s</a>',t.prefix,e.call(this))}group(){if(this.elidedGroups===0)return dr(this.address).join(":");gr(typeof this.elidedGroups=="number"),gr(typeof this.elisionBegin=="number");let t=[],[e,n]=this.address.split("::");e.length?t.push(...dr(e)):t.push("");let o=["hover-group"];for(let c=this.elisionBegin;c<this.elisionBegin+this.elidedGroups;c++)o.push((0,tt.sprintf)("group-%d",c));return t.push((0,tt.sprintf)('<span class="%s"></span>',o.join(" "))),n.length?t.push(...dr(n,this.elisionEnd)):t.push(""),this.is4()&&(gr(this.address4 instanceof F),t.pop(),t.push(this.address4.groupForV6())),t.join(":")}regularExpressionString(t=!1){let e=[],n=new L(this.correctForm());if(n.elidedGroups===0)e.push(mr(n.parsedAddress));else if(n.elidedGroups===8)e.push(Vn(8));else{let o=n.address.split("::");o[0].length&&e.push(mr(o[0].split(":"))),gr(typeof n.elidedGroups=="number"),e.push(Vn(n.elidedGroups,o[0].length!==0,o[1].length!==0)),o[1].length&&e.push(mr(o[1].split(":"))),e=[e.join(":")]}return t||(e=["(?=^|",zn,"|[^\\w\\:])(",...e,")(?=[^\\w\\:]|",zn,"|$)"]),e.join("")}regularExpression(t=!1){return new RegExp(this.regularExpressionString(t),"i")}};var ff=jt("libp2p:ip-port-to-multiaddr"),jn={ERR_INVALID_IP_PARAMETER:"ERR_INVALID_IP_PARAMETER",ERR_INVALID_PORT_PARAMETER:"ERR_INVALID_PORT_PARAMETER",ERR_INVALID_IP:"ERR_INVALID_IP"};function ei(r,t){if(typeof r!="string")throw new Q(`invalid ip provided: ${r}`,jn.ERR_INVALID_IP_PARAMETER);if(typeof t=="string"&&(t=parseInt(t)),isNaN(t))throw new Q(`invalid port provided: ${t}`,jn.ERR_INVALID_PORT_PARAMETER);try{return new F(r),_e(`/ip4/${r}/tcp/${t}`)}catch{}try{let e=new L(r);return e.is4()?_e(`/ip4/${e.to4().correctForm()}/tcp/${t}`):_e(`/ip6/${r}/tcp/${t}`)}catch{let n=`invalid ip:port for creating a multiaddr: ${r}:${t}`;throw ff.error(n),new Q(n,jn.ERR_INVALID_IP)}}var ri=X.isIPv4,pf=X.isIPv6,qn=function(r){let t=0;if(r=r.toString().trim(),ri(r)){let e=new Uint8Array(t+4);return r.split(/\./g).forEach(n=>{e[t++]=parseInt(n,10)&255}),e}if(pf(r)){let e=r.split(":",8),n;for(n=0;n<e.length;n++){let c=ri(e[n]),l;c&&(l=qn(e[n]),e[n]=C(l.slice(0,2),"base16")),l!=null&&++n<8&&e.splice(n,0,C(l.slice(2,4),"base16"))}if(e[0]==="")for(;e.length<8;)e.unshift("0");else if(e[e.length-1]==="")for(;e.length<8;)e.push("0");else if(e.length<8){for(n=0;n<e.length&&e[n]!=="";n++);let c=[n,1];for(n=9-e.length;n>0;n--)c.push("0");e.splice.apply(e,c)}let o=new Uint8Array(t+16);for(n=0;n<e.length;n++){let c=parseInt(e[n],16);o[t++]=c>>8&255,o[t++]=c&255}return o}throw new Error("invalid ip address")},ni=function(r,t=0,e){t=~~t,e=e??r.length-t;let n=new DataView(r.buffer);if(e===4){let o=[];for(let c=0;c<e;c++)o.push(r[t+c]);return o.join(".")}if(e===16){let o=[];for(let c=0;c<e;c+=2)o.push(n.getUint16(t+c).toString(16));return o.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""};var Ue={},Gn={},df=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,-1,"ip6zone"],[43,8,"ipcidr"],[53,-1,"dns",!0],[54,-1,"dns4",!0],[55,-1,"dns6",!0],[56,-1,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc"],[281,0,"webrtc-w3c"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,-1,"unix",!1,!0],[421,-1,"ipfs"],[421,-1,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,-1,"garlic64"],[448,0,"tls"],[449,-1,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,-1,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,-1,"memory"]];df.forEach(r=>{let t=mf(...r);Gn[t.code]=t,Ue[t.name]=t});function mf(r,t,e,n,o){return{code:r,size:t,name:e,resolvable:!!n,path:!!o}}function $(r){if(typeof r=="number"){if(Gn[r]!=null)return Gn[r];throw new Error(`no protocol with code: ${r}`)}else if(typeof r=="string"){if(Ue[r]!=null)return Ue[r];throw new Error(`no protocol with name: ${r}`)}throw new Error(`invalid protocol id type: ${typeof r}`)}var Ct=N(St(),1);function ci(r,t){switch($(r).code){case 4:case 41:return wf(t);case 42:return ii(t);case 6:case 273:case 33:case 132:return li(t).toString();case 53:case 54:case 55:case 56:case 400:case 449:case 777:return ii(t);case 421:return xf(t);case 444:return ai(t);case 445:return ai(t);case 466:return vf(t);default:return C(t,"base16")}}function ui(r,t){switch($(r).code){case 4:return oi(t);case 41:return oi(t);case 42:return si(t);case 6:case 273:case 33:case 132:return Hn(parseInt(t,10));case 53:case 54:case 55:case 56:case 400:case 449:case 777:return si(t);case 421:return bf(t);case 444:return Sf(t);case 445:return Tf(t);case 466:return yf(t);default:return Bt(t,"base16")}}var Wn=Object.values(It).map(r=>r.decoder),gf=function(){let r=Wn[0].or(Wn[1]);return Wn.slice(2).forEach(t=>r=r.or(t)),r}();function oi(r){if(!pt(r))throw new Error("invalid ip address");return qn(r)}function wf(r){let t=ni(r,0,r.length);if(t==null)throw new Error("ipBuff is required");if(!pt(t))throw new Error("invalid ip address");return t}function Hn(r){let t=new ArrayBuffer(2);return new DataView(t).setUint16(0,r),new Uint8Array(t)}function li(r){return new DataView(r.buffer).getUint16(r.byteOffset)}function si(r){let t=Bt(r),e=Uint8Array.from(Ct.default.encode(t.length));return P([e,t],e.length+t.length)}function ii(r){let t=Ct.default.decode(r);if(r=r.slice(Ct.default.decode.bytes),r.length!==t)throw new Error("inconsistent lengths");return C(r)}function bf(r){let t;r[0]==="Q"||r[0]==="1"?t=$t(k.decode(`z${r}`)).bytes:t=R.parse(r).multihash.bytes;let e=Uint8Array.from(Ct.default.encode(t.length));return P([e,t],e.length+t.length)}function yf(r){let t=gf.decode(r),e=Uint8Array.from(Ct.default.encode(t.length));return P([e,t],e.length+t.length)}function vf(r){let t=Ct.default.decode(r),e=r.slice(Ct.default.decode.bytes);if(e.length!==t)throw new Error("inconsistent lengths");return"u"+C(e,"base64url")}function xf(r){let t=Ct.default.decode(r),e=r.slice(Ct.default.decode.bytes);if(e.length!==t)throw new Error("inconsistent lengths");return C(e,"base58btc")}function Sf(r){let t=r.split(":");if(t.length!==2)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(t[0].length!==16)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion address.`);let e=H.decode("b"+t[0]),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=Hn(n);return P([e,o],e.length+o.length)}function Tf(r){let t=r.split(":");if(t.length!==2)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(t[0].length!==56)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion3 address.`);let e=H.decode(`b${t[0]}`),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=Hn(n);return P([e,o],e.length+o.length)}function ai(r){let t=r.slice(0,r.length-2),e=r.slice(r.length-2),n=C(t,"base32"),o=li(e);return`${n}:${o}`}var we=N(St(),1);function Ef(r){let t=[],e=r.split("/").slice(1);if(e.length===1&&e[0]==="")return[];for(let n=0;n<e.length;n++){let o=e[n],c=$(o);if(c.size===0){t.push([o]);continue}if(n++,n>=e.length)throw pi("invalid address: "+r);if(c.path===!0){t.push([o,Yn(e.slice(n).join("/"))]);break}t.push([o,e[n]])}return t}function Cf(r){let t=[];return r.map(e=>{let n=yr(e);return t.push(n.name),e.length>1&&e[1]!=null&&t.push(e[1]),null}),Yn(t.join("/"))}function Af(r){return r.map(t=>{Array.isArray(t)||(t=[t]);let e=yr(t);return t.length>1?[e.code,ui(e.code,t[1])]:[e.code]})}function Zn(r){return r.map(t=>{let e=yr(t);return t[1]!=null?[e.code,ci(e.code,t[1])]:[e.code]})}function Jn(r){return br(P(r.map(t=>{let e=yr(t),n=Uint8Array.from(we.default.encode(e.code));return t.length>1&&t[1]!=null&&(n=P([n,t[1]])),n})))}function Xn(r,t){return r.size>0?r.size/8:r.size===0?0:we.default.decode(t)+(we.default.decode.bytes??0)}function wr(r){let t=[],e=0;for(;e<r.length;){let n=we.default.decode(r,e),o=we.default.decode.bytes??0,c=$(n),l=Xn(c,r.slice(e+o));if(l===0){t.push([n]),e+=o;continue}let p=r.slice(e+o,e+o+l);if(e+=l+o,e>r.length)throw pi("Invalid address Uint8Array: "+C(r,"base16"));t.push([n,p])}return t}function Qn(r){let t=wr(r),e=Zn(t);return Cf(e)}function If(r){r=Yn(r);let t=Ef(r),e=Af(t);return Jn(e)}function fi(r){return If(r)}function br(r){let t=Bf(r);if(t!=null)throw t;return Uint8Array.from(r)}function Bf(r){try{wr(r)}catch(t){return t}}function Yn(r){return"/"+r.trim().split("/").filter(t=>t).join("/")}function pi(r){return new Error("Error parsing address: "+r)}function yr(r){return $(r[0])}var to=N(St(),1);var wi=N(mi(),1);var be=function(r,t,e,n){if(e==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?r!==t||!n:!t.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e==="m"?n:e==="a"?n.call(r):n?n.value:t.get(r)},Kn=function(r,t,e,n,o){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!o)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?r!==t||!o:!t.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?o.call(r,e):o?o.value=e:t.set(r,e),e},Le,ze,Ve,gi,Pf=Symbol.for("nodejs.util.inspect.custom"),Df=[$("dns").code,$("dns4").code,$("dns6").code,$("dnsaddr").code],Of=new Map,bi=Symbol.for("@multiformats/js-multiaddr/multiaddr");function _f(r){return!!r?.[bi]}var Ot=class{constructor(t){if(Le.set(this,void 0),ze.set(this,void 0),Ve.set(this,void 0),this[gi]=!0,t==null&&(t=""),t instanceof Uint8Array)this.bytes=br(t);else if(typeof t=="string"){if(t.length>0&&t.charAt(0)!=="/")throw new Error(`multiaddr "${t}" must start with a "/"`);this.bytes=fi(t)}else if(_f(t))this.bytes=br(t.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return be(this,Le,"f")==null&&Kn(this,Le,Qn(this.bytes),"f"),be(this,Le,"f")}toJSON(){return this.toString()}toOptions(){let t,e,n,o,c="",l=$("tcp"),p=$("udp"),v=$("ip4"),T=$("ip6"),f=$("dns6"),w=$("ip6zone");for(let[g,d]of this.stringTuples())g===w.code&&(c=`%${d??""}`),Df.includes(g)&&(e=l.name,o=443,n=`${d??""}${c}`,t=g===f.code?6:4),(g===l.code||g===p.code)&&(e=$(g).name,o=parseInt(d??"")),(g===v.code||g===T.code)&&(e=$(g).name,n=`${d??""}${c}`,t=g===T.code?6:4);if(t==null||e==null||n==null||o==null)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:t,host:n,transport:e,port:o}}protos(){return this.protoCodes().map(t=>Object.assign({},$(t)))}protoCodes(){let t=[],e=this.bytes,n=0;for(;n<e.length;){let o=to.default.decode(e,n),c=to.default.decode.bytes??0,l=$(o),p=Xn(l,e.slice(n+c));n+=p+c,t.push(o)}return t}protoNames(){return this.protos().map(t=>t.name)}tuples(){return be(this,ze,"f")==null&&Kn(this,ze,wr(this.bytes),"f"),be(this,ze,"f")}stringTuples(){return be(this,Ve,"f")==null&&Kn(this,Ve,Zn(this.tuples()),"f"),be(this,Ve,"f")}encapsulate(t){return t=new Ot(t),new Ot(this.toString()+t.toString())}decapsulate(t){let e=t.toString(),n=this.toString(),o=n.lastIndexOf(e);if(o<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${t.toString()}`);return new Ot(n.slice(0,o))}decapsulateCode(t){let e=this.tuples();for(let n=e.length-1;n>=0;n--)if(e[n][0]===t)return new Ot(Jn(e.slice(0,n)));return this}getPeerId(){try{let e=this.stringTuples().filter(n=>n[0]===Ue.ipfs.code).pop();if(e?.[1]!=null){let n=e[1];return n[0]==="Q"||n[0]==="1"?C(k.decode(`z${n}`),"base58btc"):C(R.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){let t=null;try{t=this.stringTuples().filter(e=>$(e[0]).path===!0)[0][1],t==null&&(t=null)}catch{t=null}return t}equals(t){return ie(this.bytes,t.bytes)}async resolve(t){let e=this.protos().find(c=>c.resolvable);if(e==null)return[this];let n=Of.get(e.name);if(n==null)throw(0,wi.default)(new Error(`no available resolver for ${e.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await n(this,t)).map(c=>new Ot(c))}nodeAddress(){let t=this.toOptions();if(t.transport!=="tcp"&&t.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${t.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:t.family,address:t.host,port:t.port}}isThinWaistAddress(t){let e=(t??this).protos();return!(e.length!==2||e[0].code!==4&&e[0].code!==41||e[1].code!==6&&e[1].code!==273)}[(Le=new WeakMap,ze=new WeakMap,Ve=new WeakMap,gi=bi,Pf)](){return`Multiaddr(${Qn(this.bytes)})`}};function yi(r){return new Ot(r)}var eo=N(xt("os"),1),vi=N(xt("path"),1),kf={ip4:"IPv4",ip6:"IPv6"};function ye(r){let t=r.getPath();return t!=null?eo.default.platform()==="win32"?{path:vi.default.join("\\\\.\\pipe\\",t)}:{path:t}:r.toOptions()}function ro(r,t,e){let n=o=>yi(`/${r}/${o}/tcp/${e}`);return(Ff(t)?$f(kf[r]):[t]).map(n)}function Ff(r){return["0.0.0.0","::"].includes(r)}var Nf=eo.default.networkInterfaces();function $f(r){let t=[];for(let[,e]of Object.entries(Nf))if(e!=null)for(let n of e)n.family===r&&t.push(n.address);return t}var vt=jt("libp2p:tcp:socket"),vr=(r,t)=>{let e=t.metrics,n=t.metricPrefix??"",o=t.socketInactivityTimeout??3e5,c=t.socketCloseTimeout??2e3,l=t.listening;l?.onUnixPath&&(t.remoteAddr=l.addr),t.remoteAddr?.getPath()!=null&&(t.localAddr=t.remoteAddr);let p,v;if(t.remoteAddr!=null){v=t.remoteAddr;let y=ye(v);p=y.path??`${y.host??""}:${y.port??""}`}else{if(r.remoteAddress==null||r.remotePort==null)throw new Q("Could not determine remote address or port","ERR_NO_REMOTE_ADDRESS");let{remoteAddress:y,remotePort:g}=r;v=ei(y,g),p=`${y??""}:${g??""}`}let{sink:T,source:f}=xi.default.duplex(r);r.setTimeout(o,()=>{vt("%s socket read timeout",p),e?.increment({[`${n}timeout`]:!0});let y;r.readable&&(y=new Q("Socket read timeout","ERR_SOCKET_READ_TIMEOUT")),r.destroy(y)}),r.once("close",()=>{vt("%s socket read timeout",p),e?.increment({[`${n}close`]:!0}),w.timeline.close==null&&(w.timeline.close=Date.now())}),r.once("end",()=>{vt("socket ended",w.remoteAddr.toString()),e?.increment({[`${n}end`]:!0})});let w={async sink(y){try{await T(y)}catch(g){g.type!=="aborted"&&vt(g)}r.end()},source:f,remoteAddr:v,timeline:{open:Date.now()},async close(){if(r.destroyed){vt("%s socket was already destroyed when trying to close",p);return}vt("%s closing socket",p),await new Promise((y,g)=>{let d=Date.now(),A;r.once("close",()=>{vt("%s socket closed",p),A&&clearTimeout(A),y()}),r.once("error",M=>{vt("%s socket error",p,M),w.timeline.close==null&&(w.timeline.close=Date.now()),r.destroyed&&A&&clearTimeout(A),g(M)}),r.setTimeout(c),r.end(),r.writableLength>0?(A=setTimeout(()=>{r.destroyed?(vt("%s is already destroyed",p),y()):(vt("%s socket close timeout after %dms, destroying it manually",p,Date.now()-d),r.destroy(new Q("Socket close timeout","ERR_SOCKET_CLOSE_TIMEOUT")))},c).unref(),r.once("drain",()=>{vt("%s socket drained",p),r.destroy()})):r.destroy()})}};return w};var Si=N(xt("net"),1);var Kt=function(r,t,e,n){if(e==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?r!==t||!n:!t.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e==="m"?n:e==="a"?n.call(r):n?n.value:t.get(r)},_t,xr=class extends EventTarget{constructor(){super(...arguments),_t.set(this,new Map)}listenerCount(t){let e=Kt(this,_t,"f").get(t);return e==null?0:e.length}addEventListener(t,e,n){super.addEventListener(t,e,n);let o=Kt(this,_t,"f").get(t);o==null&&(o=[],Kt(this,_t,"f").set(t,o)),o.push({callback:e,once:(n!==!0&&n!==!1&&n?.once)??!1})}removeEventListener(t,e,n){super.removeEventListener(t.toString(),e??null,n);let o=Kt(this,_t,"f").get(t);o!=null&&(o=o.filter(({callback:c})=>c!==e),Kt(this,_t,"f").set(t,o))}dispatchEvent(t){let e=super.dispatchEvent(t),n=Kt(this,_t,"f").get(t.type);return n==null||(n=n.filter(({once:o})=>!o),Kt(this,_t,"f").set(t.type,n)),e}safeDispatchEvent(t,e){return this.dispatchEvent(new ve(t,e))}};_t=new WeakMap;var no=class extends Event{constructor(t,e){super(t,e),this.detail=e?.detail}},ve=globalThis.CustomEvent??no;var lt=jt("libp2p:tcp:listener");async function oo(r){try{await r.close()}catch(t){lt.error("an error occurred closing the connection",t)}}var zf=1,Vf=0,Sr=class extends xr{constructor(t){if(super(),this.context=t,this.connections=new Set,this.status={started:!1},t.keepAlive=t.keepAlive??!0,this.addr="unknown",this.server=Si.default.createServer(t,this.onSocket.bind(this)),t.maxConnections!==void 0&&(this.server.maxConnections=t.maxConnections),t.closeServerOnMaxConnections!=null&&t.closeServerOnMaxConnections.closeAbove<t.closeServerOnMaxConnections.listenBelow)throw Error("closeAbove must be >= listenBelow");if(t.backlog!=null&&t.backlog<=0)throw Error("backlog must be > 0");this.server.on("listening",()=>{if(t.metrics!=null){let e=this.server.address();e==null?this.addr="unknown":typeof e=="string"?this.addr=e:this.addr=`${e.address}:${e.port}`,t.metrics?.registerMetricGroup("libp2p_tcp_inbound_connections_total",{label:"address",help:"Current active connections in TCP listener",calculate:()=>({[this.addr]:this.connections.size})}),this.metrics={status:t.metrics.registerMetricGroup("libp2p_tcp_listener_status_info",{label:"address",help:"Current status of the TCP listener socket"}),errors:t.metrics.registerMetricGroup("libp2p_tcp_listener_errors_total",{label:"address",help:"Total count of TCP listener errors by type"}),events:t.metrics.registerMetricGroup("libp2p_tcp_listener_events_total",{label:"address",help:"Total count of TCP listener events by type"})},this.metrics?.status.update({[this.addr]:zf})}this.dispatchEvent(new ve("listening"))}).on("error",e=>{this.metrics?.errors.increment({[`${this.addr} listen_error`]:!0}),this.dispatchEvent(new ve("error",{detail:e}))}).on("close",()=>{this.metrics?.status.update({[this.addr]:Vf}),this.dispatchEvent(new ve("close"))})}onSocket(t){t.on("error",n=>{lt("socket error",n),this.metrics?.events.increment({[`${this.addr} error`]:!0})});let e;try{e=vr(t,{listening:this.status.started?{addr:this.status.listeningAddr,onUnixPath:this.status.listenOnUnixPath}:void 0,socketInactivityTimeout:this.context.socketInactivityTimeout,socketCloseTimeout:this.context.socketCloseTimeout,metrics:this.metrics?.events,metricPrefix:`${this.addr} `})}catch(n){lt.error("inbound connection failed",n),this.metrics?.errors.increment({[`${this.addr} inbound_to_connection`]:!0});return}lt("new inbound connection %s",e.remoteAddr);try{this.context.upgrader.upgradeInbound(e).then(n=>{lt("inbound connection upgraded %s",e.remoteAddr),this.connections.add(e),t.once("close",()=>{this.connections.delete(e),this.context.closeServerOnMaxConnections!=null&&this.connections.size<this.context.closeServerOnMaxConnections.listenBelow&&this.netListen().catch(o=>{lt.error("error attempting to listen server once connection count under limit",o),this.context.closeServerOnMaxConnections?.onListenError?.(o)})}),this.context.handler!=null&&this.context.handler(n),this.context.closeServerOnMaxConnections!=null&&this.connections.size>=this.context.closeServerOnMaxConnections.closeAbove&&this.netClose(),this.dispatchEvent(new ve("connection",{detail:n}))}).catch(async n=>{lt.error("inbound connection failed",n),this.metrics?.errors.increment({[`${this.addr} inbound_upgrade`]:!0}),await oo(e)}).catch(n=>{lt.error("closing inbound connection failed",n)})}catch(n){lt.error("inbound connection failed",n),oo(e).catch(o=>{lt.error("closing inbound connection failed",o),this.metrics?.errors.increment({[`${this.addr} inbound_closing_failed`]:!0})})}}getAddrs(){if(!this.status.started)return[];let t=[],e=this.server.address(),{listeningAddr:n,peerId:o}=this.status;if(e==null)return[];if(typeof e=="string")t=[n];else try{n.toString().startsWith("/ip4")?t=t.concat(ro("ip4",e.address,e.port)):e.family==="IPv6"&&(t=t.concat(ro("ip6",e.address,e.port)))}catch(c){lt.error("could not turn %s:%s into multiaddr",e.address,e.port,c)}return t.map(c=>o!=null?c.encapsulate(`/p2p/${o}`):c)}async listen(t){if(this.status.started)throw Error("server is already listening");let e=t.getPeerId(),n=e==null?t.decapsulateCode(421):t,o=n.getPath()!=null,c=ye(n),{backlog:l}=this.context;this.status={started:!0,listeningAddr:n,listenOnUnixPath:o,peerId:e,netConfig:l?{...c,backlog:l}:c},await this.netListen()}async close(){await Promise.all(Array.from(this.connections.values()).map(async t=>await oo(t))),this.netClose()}async netListen(){if(!this.status.started||this.server.listening)return;let t=this.status.netConfig;await new Promise((e,n)=>{this.server.once("error",n),this.server.listen(t,e)}),lt("Listening on %s",this.server.address())}netClose(){!this.status.started||!this.server.listening||(lt("Closing server on %s",this.server.address()),this.server.close())}};var Ei=Symbol.for("@libp2p/transport");var Ti;(function(r){r[r.FATAL_ALL=0]="FATAL_ALL",r[r.NO_FATAL=1]="NO_FATAL"})(Ti||(Ti={}));var kt=jt("libp2p:tcp"),io=class{constructor(t,e={}){this.opts=e,this.components=t,t.metrics!=null&&(this.metrics={dialerEvents:t.metrics.registerCounterGroup("libp2p_tcp_dialer_events_total",{label:"event",help:"Total count of TCP dialer events by type"})})}get[Ei](){return!0}get[Symbol.toStringTag](){return"@libp2p/tcp"}async dial(t,e){e.keepAlive=e.keepAlive??!0;let n=await this._connect(t,e);n.on("error",p=>{kt("socket error",p)});let o=vr(n,{remoteAddr:t,socketInactivityTimeout:this.opts.outboundSocketInactivityTimeout,socketCloseTimeout:this.opts.socketCloseTimeout,metrics:this.metrics?.dialerEvents}),c=()=>{o.close().catch(p=>{kt.error("Error closing maConn after abort",p)})};e.signal?.addEventListener("abort",c,{once:!0}),kt("new outbound connection %s",o.remoteAddr);let l=await e.upgrader.upgradeOutbound(o);if(kt("outbound connection %s upgraded",o.remoteAddr),e.signal?.removeEventListener("abort",c),e.signal?.aborted===!0)throw l.close().catch(p=>{kt.error("Error closing conn after abort",p)}),new Rt;return l}async _connect(t,e){if(e.signal?.aborted===!0)throw new Rt;return await new Promise((n,o)=>{let c=Date.now(),l=ye(t),p=l.path??`${l.host??""}:${l.port}`;kt("dialing %j",l);let v=Ci.default.connect(l),T=d=>{d.message=`connection error ${p}: ${d.message}`,this.metrics?.dialerEvents.increment({error:!0}),g(d)},f=()=>{kt("connection timeout %s",p),this.metrics?.dialerEvents.increment({timeout:!0});let d=new Q(`connection timeout after ${Date.now()-c}ms`,"ERR_CONNECT_TIMEOUT");v.emit("error",d)},w=()=>{kt("connection opened %j",l),this.metrics?.dialerEvents.increment({connect:!0}),g()},y=()=>{kt("connection aborted %j",l),this.metrics?.dialerEvents.increment({abort:!0}),v.destroy(),g(new Rt)},g=d=>{if(v.removeListener("error",T),v.removeListener("timeout",f),v.removeListener("connect",w),e.signal!=null&&e.signal.removeEventListener("abort",y),d!=null)return o(d);n(v)};v.on("error",T),v.on("timeout",f),v.on("connect",w),e.signal!=null&&e.signal.addEventListener("abort",y)})}createListener(t){return new Sr({...t,maxConnections:this.opts.maxConnections,closeServerOnMaxConnections:this.opts.closeServerOnMaxConnections,socketInactivityTimeout:this.opts.inboundSocketInactivityTimeout,socketCloseTimeout:this.opts.socketCloseTimeout,metrics:this.components.metrics})}filter(t){return t=Array.isArray(t)?t:[t],t.filter(e=>e.protoCodes().includes(290)?!1:e.protoCodes().includes(400)?!0:zt.matches(e.decapsulateCode(421)))}};function Gf(r={}){return(t={})=>new io(t,r)}return fc(Wf);})();
return Libp2PTcp}));
